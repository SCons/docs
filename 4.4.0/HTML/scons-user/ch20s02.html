<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>20.2. Adding a search path to a scanner: FindPathDirs</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 4.4.0"><link rel="up" href="ch20.html" title="Chapter 20. Extending SCons: Writing Your Own Scanners"><link rel="prev" href="ch20.html" title="Chapter 20. Extending SCons: Writing Your Own Scanners"><link rel="next" href="ch20s03.html" title="20.3. Using scanners with Builders"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">20.2. Adding a search path to a scanner: <code class="function">FindPathDirs</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch20.html">Prev</a> </td><th width="60%" align="center">Chapter 20. Extending <span class="application">SCons</span>: Writing Your Own Scanners</th><td width="20%" align="right"> <a accesskey="n" href="ch20s03.html">Next</a></td></tr></table><hr></div><div class="section" title="20.2. Adding a search path to a scanner: FindPathDirs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp105548826045520"></a>20.2. Adding a search path to a scanner: <code class="function">FindPathDirs</code></h2></div></div></div><p>

    If the build tool in question will use a path variable to search
    for included files or other dependencies, then the Scanner will
    need to take that path variable into account as well -
    <a class="link" href="apa.html#cv-CPPPATH"><code class="envar">$CPPPATH</code></a> and <a class="link" href="apa.html#cv-LIBPATH"><code class="envar">$LIBPATH</code></a> are used this way,
    for example.  The path to search is passed to your
    scanner as the <em class="parameter"><code>path</code></em> argument.  Path variables
    may be lists of nodes, semicolon-separated strings, or even
    contain <span>construction variables</span> which need to be expanded.  
    <span class="application">SCons</span> provides the <a class="link" href="apd.html#f-FindPathDirs"><code class="function">FindPathDirs</code></a> function which returns
    a callable to expand a given path (given as a SCons <span>construction variable</span>
    name) to a list of paths at the time the scanner is called.
    Deferring evaluation until that point allows, for instance,
    the path to contain <a class="link" href="apa.html#cv-TARGET"><code class="envar">$TARGET</code></a> references which differ for
    each file scanned.

    </p><p>

    Using <code class="function">FindPathDirs</code> is quite easy.  Continuing the above example,
    using <code class="varname">KPATH</code> as the <span>construction variable</span> with the search path
    (analogous to <a class="link" href="apa.html#cv-CPPPATH"><code class="envar">$CPPPATH</code></a>), we just modify the call to
    the <code class="classname">Scanner</code> factory function to include a path keyword arg:

    </p><pre class="programlisting">
kscan = Scanner(function=kfile_scan, skeys=['.k'], path_function=FindPathDirs('KPATH'))
      </pre><p>
    
    <code class="function">FindPathDirs</code> returns a callable object that, when called, will
    essentially expand the elements in <code class="literal">env['KPATH']</code>
    and tell the scanner to search in those dirs.  It will also properly
    add related repository and variant dirs to the search list.  As a side
    note, the returned method stores the path in an efficient way so
    lookups are fast even when variable substitutions may be needed.
    This is important since many files get scanned in a typical build.
    
    </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch20.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch20.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch20s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 20. Extending <span class="application">SCons</span>: Writing Your Own Scanners </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 20.3. Using scanners with Builders</td></tr></table></div></body></html>
