
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SCons.Util &#8212; SCons 4.5.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../">
      
      
      
      <h1 class="site-logo" id="site-title">SCons 4.5.1 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../SCons/">
   SCons package
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.Node/">
     SCons.Node package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.Platform/">
     SCons.Platform package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.Scanner/">
     SCons.Scanner package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.Script/">
     SCons.Script package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.Taskmaster/">
     SCons.Taskmaster package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.Tool/">
     SCons.Tool package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.Variables/">
     SCons.Variables package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../SCons.compat/">
     SCons.compat package
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.compat/">
   SCons.compat package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.Node/">
   SCons.Node package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.Platform/">
   SCons.Platform package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.Scanner/">
   SCons.Scanner package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.Script/">
   SCons.Script package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.Taskmaster/">
   SCons.Taskmaster package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.Tool/">
   SCons.Tool package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../SCons.Variables/">
   SCons.Variables package
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <h1>Source code for SCons.Util</h1><div class="highlight"><pre>
<span></span><span class="c1"># MIT License</span>
<span class="c1">#</span>
<span class="c1"># Copyright The SCons Foundation</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining</span>
<span class="c1"># a copy of this software and associated documentation files (the</span>
<span class="c1"># &quot;Software&quot;), to deal in the Software without restriction, including</span>
<span class="c1"># without limitation the rights to use, copy, modify, merge, publish,</span>
<span class="c1"># distribute, sublicense, and/or sell copies of the Software, and to</span>
<span class="c1"># permit persons to whom the Software is furnished to do so, subject to</span>
<span class="c1"># the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included</span>
<span class="c1"># in all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY</span>
<span class="c1"># KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE</span>
<span class="c1"># WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span>
<span class="c1"># NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE</span>
<span class="c1"># LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION</span>
<span class="c1"># OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION</span>
<span class="c1"># WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">&quot;&quot;&quot;SCons utility functions</span>

<span class="sd">This package contains routines for use by other parts of SCons.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">UserDict</span><span class="p">,</span> <span class="n">UserList</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">deque</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">suppress</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">MethodType</span><span class="p">,</span> <span class="n">FunctionType</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">Formatter</span>

<span class="kn">from</span> <span class="nn">.types</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DictTypes</span><span class="p">,</span>
    <span class="n">ListTypes</span><span class="p">,</span>
    <span class="n">SequenceTypes</span><span class="p">,</span>
    <span class="n">StringTypes</span><span class="p">,</span>
    <span class="n">BaseStringTypes</span><span class="p">,</span>
    <span class="n">Null</span><span class="p">,</span>
    <span class="n">NullSeq</span><span class="p">,</span>
    <span class="n">is_Dict</span><span class="p">,</span>
    <span class="n">is_List</span><span class="p">,</span>
    <span class="n">is_Sequence</span><span class="p">,</span>
    <span class="n">is_Tuple</span><span class="p">,</span>
    <span class="n">is_String</span><span class="p">,</span>
    <span class="n">is_Scalar</span><span class="p">,</span>
    <span class="n">to_String</span><span class="p">,</span>
    <span class="n">to_String_for_subst</span><span class="p">,</span>
    <span class="n">to_String_for_signature</span><span class="p">,</span>
    <span class="n">to_bytes</span><span class="p">,</span>
    <span class="n">to_str</span><span class="p">,</span>
    <span class="n">get_env_bool</span><span class="p">,</span>
    <span class="n">get_os_env_bool</span><span class="p">,</span>
    <span class="n">get_environment_var</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.hashes</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ALLOWED_HASH_FORMATS</span><span class="p">,</span>
    <span class="n">DEFAULT_HASH_FORMATS</span><span class="p">,</span>
    <span class="n">get_hash_format</span><span class="p">,</span>
    <span class="n">set_hash_format</span><span class="p">,</span>
    <span class="n">get_current_hash_algorithm_used</span><span class="p">,</span>
    <span class="n">hash_signature</span><span class="p">,</span>
    <span class="n">hash_file_signature</span><span class="p">,</span>
    <span class="n">hash_collect</span><span class="p">,</span>
    <span class="n">MD5signature</span><span class="p">,</span>
    <span class="n">MD5filesignature</span><span class="p">,</span>
    <span class="n">MD5collect</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.envs</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MethodWrapper</span><span class="p">,</span>
    <span class="n">PrependPath</span><span class="p">,</span>
    <span class="n">AppendPath</span><span class="p">,</span>
    <span class="n">AddPathIfNotExists</span><span class="p">,</span>
    <span class="n">AddMethod</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># Note: the Util package cannot import other parts of SCons globally without</span>
<span class="c1"># hitting import loops. Both of these modules import SCons.Util early on,</span>
<span class="c1"># and are imported in many other modules:</span>
<span class="c1"># --&gt; SCons.Warnings</span>
<span class="c1"># --&gt; SCons.Errors</span>
<span class="c1"># If you run into places that have to do local imports for this reason,</span>
<span class="c1"># annotate them for pylint and for human readers to know why:</span>
<span class="c1">#   pylint: disable=import-outside-toplevel</span>
<span class="c1"># Be aware that Black can break this if the annotated line is too</span>
<span class="c1"># long and it wants to split:</span>
<span class="c1">#       from SCons.Errors import (</span>
<span class="c1">#           SConsEnvironmentError,</span>
<span class="c1">#       )  # pylint: disable=import-outside-toplevel</span>
<span class="c1"># That&#39;s syntactically valid, but pylint won&#39;t recorgnize it with the</span>
<span class="c1"># annotation at the end, it would have to be on the first line</span>
<span class="c1"># (issues filed upstream, for now just be aware)</span>

<span class="n">PYPY</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;pypy_translation_info&#39;</span><span class="p">)</span>

<span class="c1"># this string will be hashed if a Node refers to a file that doesn&#39;t exist</span>
<span class="c1"># in order to distinguish from a file that exists but is empty.</span>
<span class="n">NOFILE</span> <span class="o">=</span> <span class="s2">&quot;SCONS_MAGIC_MISSING_FILE_STRING&quot;</span>

<span class="c1"># unused?</span>
<div class="viewcode-block" id="dictify"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.dictify">[docs]</a><span class="k">def</span> <span class="nf">dictify</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span></div>

<span class="n">_ALTSEP</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">altsep</span>
<span class="k">if</span> <span class="n">_ALTSEP</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
    <span class="c1"># My ActivePython 2.0.1 doesn&#39;t set os.altsep!  What gives?</span>
    <span class="n">_ALTSEP</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span>
<span class="k">if</span> <span class="n">_ALTSEP</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">rightmost_separator</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sep</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">sep</span><span class="p">),</span> <span class="n">path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">_ALTSEP</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
<div class="viewcode-block" id="rightmost_separator"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.rightmost_separator">[docs]</a>    <span class="k">def</span> <span class="nf">rightmost_separator</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sep</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span></div>

<span class="c1"># First two from the Python Cookbook, just for completeness.</span>
<span class="c1"># (Yeah, yeah, YAGNI...)</span>
<div class="viewcode-block" id="containsAny"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.containsAny">[docs]</a><span class="k">def</span> <span class="nf">containsAny</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">pat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether string `s` contains ANY of the items in `pat`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pat</span><span class="p">)</span></div>

<div class="viewcode-block" id="containsAll"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.containsAll">[docs]</a><span class="k">def</span> <span class="nf">containsAll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">pat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether string `s` contains ALL of the items in `pat`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">c</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pat</span><span class="p">)</span></div>

<div class="viewcode-block" id="containsOnly"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.containsOnly">[docs]</a><span class="k">def</span> <span class="nf">containsOnly</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">pat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether string `s` contains ONLY items in `pat`.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pat</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span></div>


<span class="c1"># TODO: Verify this method is STILL faster than os.path.splitext</span>
<div class="viewcode-block" id="splitext"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.splitext">[docs]</a><span class="k">def</span> <span class="nf">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split `path` into a (root, ext) pair.</span>

<span class="sd">    Same as :mod:`os.path.splitext` but faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="n">rightmost_separator</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="n">dot</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="c1"># An ext is only real if it has at least one non-digit char</span>
    <span class="k">if</span> <span class="n">dot</span> <span class="o">&gt;</span> <span class="n">sep</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">path</span><span class="p">[</span><span class="n">dot</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">path</span><span class="p">[:</span><span class="n">dot</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="n">dot</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="updrive"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.updrive">[docs]</a><span class="k">def</span> <span class="nf">updrive</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the drive letter (if any) upper case.</span>

<span class="sd">    This is useful because Windows is inconsistent on the case</span>
<span class="sd">    of the drive letter, which can cause inconsistencies when</span>
<span class="sd">    calculating command signatures.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">drive</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitdrive</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">drive</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">drive</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">rest</span>
    <span class="k">return</span> <span class="n">path</span></div>

<div class="viewcode-block" id="NodeList"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.NodeList">[docs]</a><span class="k">class</span> <span class="nc">NodeList</span><span class="p">(</span><span class="n">UserList</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A list of Nodes with special attribute retrieval.</span>

<span class="sd">    Unlike an ordinary list, access to a member&#39;s attribute returns a</span>
<span class="sd">    `NodeList` containing the same attribute for each member.  Although</span>
<span class="sd">    this can hold any object, it is intended for use when processing</span>
<span class="sd">    Nodes, where fetching an attribute of each member is very commone,</span>
<span class="sd">    for example getting the content signature of each node.  The term</span>
<span class="sd">    &quot;attribute&quot; here includes the string representation.</span>

<span class="sd">    &gt;&gt;&gt; someList = NodeList([&#39;  foo  &#39;, &#39;  bar  &#39;])</span>
<span class="sd">    &gt;&gt;&gt; someList.strip()</span>
<span class="sd">    [&#39;foo&#39;, &#39;bar&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NodeList&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<div class="viewcode-block" id="NodeList.__getattr__"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.NodeList.__getattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NodeList&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a NodeList of `name` from each member.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="NodeList.__getitem__"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.NodeList.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns one item, forces a `NodeList` if `index` is a slice.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: annotate return how? Union[] - don&#39;t know type of single item</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="DisplayEngine"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.DisplayEngine">[docs]</a><span class="k">class</span> <span class="nc">DisplayEngine</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A callable class used to display SCons messages.&quot;&quot;&quot;</span>

    <span class="n">print_it</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">append_newline</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_it</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">append_newline</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># Stdout might be connected to a pipe that has been closed</span>
        <span class="c1"># by now. The most likely reason for the pipe being closed</span>
        <span class="c1"># is that the user has press ctrl-c. It this is the case,</span>
        <span class="c1"># then SCons is currently shutdown. We therefore ignore</span>
        <span class="c1"># IOError&#39;s here so that SCons can continue and shutdown</span>
        <span class="c1"># properly so that the .sconsign is correctly written</span>
        <span class="c1"># before SCons exits.</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>

<div class="viewcode-block" id="DisplayEngine.set_mode"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.DisplayEngine.set_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_it</span> <span class="o">=</span> <span class="n">mode</span></div></div>

<span class="n">display</span> <span class="o">=</span> <span class="n">DisplayEngine</span><span class="p">()</span>


<span class="c1"># TODO: W0102: Dangerous default value [] as argument (dangerous-default-value)</span>
<div class="viewcode-block" id="render_tree"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.render_tree">[docs]</a><span class="k">def</span> <span class="nf">render_tree</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">child_func</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">visited</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render a tree of nodes into an ASCII tree view.</span>

<span class="sd">    Args:</span>
<span class="sd">        root: the root node of the tree</span>
<span class="sd">        child_func: the function called to get the children of a node</span>
<span class="sd">        prune: don&#39;t visit the same node twice</span>
<span class="sd">        margin: the format of the left margin to use for children of `root`.</span>
<span class="sd">          1 results in a pipe, and 0 results in no pipe.</span>
<span class="sd">        visited: a dictionary of visited nodes in the current branch if</span>
<span class="sd">          `prune` is 0, or in the whole tree if `prune` is 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rname</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="c1"># Initialize &#39;visited&#39; dict, if required</span>
    <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">children</span> <span class="o">=</span> <span class="n">child_func</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">pipe</span> <span class="ow">in</span> <span class="n">margin</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">pipe</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">retval</span> <span class="o">+</span> <span class="s2">&quot;| &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">retval</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span>

    <span class="k">if</span> <span class="n">rname</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">retval</span> <span class="o">+</span> <span class="s2">&quot;+-[&quot;</span> <span class="o">+</span> <span class="n">rname</span> <span class="o">+</span> <span class="s2">&quot;]</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="n">retval</span> <span class="o">=</span> <span class="n">retval</span> <span class="o">+</span> <span class="s2">&quot;+-&quot;</span> <span class="o">+</span> <span class="n">rname</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">prune</span><span class="p">:</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">visited</span><span class="p">)</span>
    <span class="n">visited</span><span class="p">[</span><span class="n">rname</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">children</span><span class="p">):</span>
        <span class="n">margin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="n">retval</span> <span class="o">+</span> <span class="n">render_tree</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">child_func</span><span class="p">,</span> <span class="n">prune</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">visited</span><span class="p">)</span>
        <span class="n">margin</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="IDX"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.IDX">[docs]</a><span class="k">def</span> <span class="nf">IDX</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate in index into strings from the tree legends.</span>

<span class="sd">    These are always a choice between two, so bool works fine.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></div>

<span class="c1"># unicode line drawing chars:</span>
<span class="n">BOX_HORIZ</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x2500</span><span class="p">)</span>  <span class="c1"># &#39;─&#39;</span>
<span class="n">BOX_VERT</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x2502</span><span class="p">)</span>  <span class="c1"># &#39;│&#39;</span>
<span class="n">BOX_UP_RIGHT</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x2514</span><span class="p">)</span>  <span class="c1"># &#39;└&#39;</span>
<span class="n">BOX_DOWN_RIGHT</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x250c</span><span class="p">)</span>  <span class="c1"># &#39;┌&#39;</span>
<span class="n">BOX_DOWN_LEFT</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x2510</span><span class="p">)</span>   <span class="c1"># &#39;┐&#39;</span>
<span class="n">BOX_UP_LEFT</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x2518</span><span class="p">)</span>  <span class="c1"># &#39;┘&#39;</span>
<span class="n">BOX_VERT_RIGHT</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x251c</span><span class="p">)</span>  <span class="c1"># &#39;├&#39;</span>
<span class="n">BOX_HORIZ_DOWN</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x252c</span><span class="p">)</span>  <span class="c1"># &#39;┬&#39;</span>


<span class="c1"># TODO: W0102: Dangerous default value [] as argument (dangerous-default-value)</span>
<div class="viewcode-block" id="print_tree"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.print_tree">[docs]</a><span class="k">def</span> <span class="nf">print_tree</span><span class="p">(</span>
    <span class="n">root</span><span class="p">,</span>
    <span class="n">child_func</span><span class="p">,</span>
    <span class="n">prune</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">showtags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">visited</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lastChild</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">singleLineDraw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print a tree of nodes.</span>

<span class="sd">    This is like func:`render_tree`, except it prints lines directly instead</span>
<span class="sd">    of creating a string representation in memory, so that huge trees can</span>
<span class="sd">    be handled.</span>

<span class="sd">    Args:</span>
<span class="sd">        root: the root node of the tree</span>
<span class="sd">        child_func: the function called to get the children of a node</span>
<span class="sd">        prune: don&#39;t visit the same node twice</span>
<span class="sd">        showtags: print status information to the left of each node line</span>
<span class="sd">        margin: the format of the left margin to use for children of *root*.</span>
<span class="sd">          1 results in a pipe, and 0 results in no pipe.</span>
<span class="sd">        visited: a dictionary of visited nodes in the current branch if</span>
<span class="sd">          *prune* is 0, or in the whole tree if *prune* is 1.</span>
<span class="sd">        lastChild: this is the last leaf of a branch</span>
<span class="sd">        singleLineDraw: use line-drawing characters rather than ASCII.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rname</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="c1"># Initialize &#39;visited&#39; dict, if required</span>
    <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">showtags</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">showtags</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39; E         = exists</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;  R        = exists in repository only</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;   b       = implicit builder</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;   B       = explicit builder</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;    S      = side effect</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;     P     = precious</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;      A    = always build</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;       C   = current</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;        N  = no clean</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;         H = no cache</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>

        <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;[&#39;</span><span class="p">,</span>
            <span class="s1">&#39; E&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">exists</span><span class="p">())],</span>
            <span class="s1">&#39; R&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">rexists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">exists</span><span class="p">())],</span>
            <span class="s1">&#39; BbB&#39;</span><span class="p">[</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">][</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">has_explicit_builder</span><span class="p">())]</span> <span class="o">+</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">][</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">has_builder</span><span class="p">())]</span>
            <span class="p">],</span>
            <span class="s1">&#39; S&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">side_effect</span><span class="p">)],</span>
            <span class="s1">&#39; P&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">precious</span><span class="p">)],</span>
            <span class="s1">&#39; A&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">always_build</span><span class="p">)],</span>
            <span class="s1">&#39; C&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">is_up_to_date</span><span class="p">())],</span>
            <span class="s1">&#39; N&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">noclean</span><span class="p">)],</span>
            <span class="s1">&#39; H&#39;</span><span class="p">[</span><span class="n">IDX</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">nocache</span><span class="p">)],</span>
            <span class="s1">&#39;]&#39;</span>
        <span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">MMM</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">singleLineDraw</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="n">BOX_VERT</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">][</span><span class="n">m</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot;| &quot;</span><span class="p">][</span><span class="n">m</span><span class="p">]</span>

    <span class="n">margins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">MMM</span><span class="p">,</span> <span class="n">margin</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">children</span> <span class="o">=</span> <span class="n">child_func</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">cross</span> <span class="o">=</span> <span class="s2">&quot;+-&quot;</span>
    <span class="k">if</span> <span class="n">singleLineDraw</span><span class="p">:</span>
        <span class="n">cross</span> <span class="o">=</span> <span class="n">BOX_VERT_RIGHT</span> <span class="o">+</span> <span class="n">BOX_HORIZ</span>   <span class="c1"># sign used to point to the leaf.</span>
        <span class="c1"># check if this is the last leaf of the branch</span>
        <span class="k">if</span> <span class="n">lastChild</span><span class="p">:</span>
            <span class="c1"># if this if the last leaf, then terminate:</span>
            <span class="n">cross</span> <span class="o">=</span> <span class="n">BOX_UP_RIGHT</span> <span class="o">+</span> <span class="n">BOX_HORIZ</span>  <span class="c1"># sign for the last leaf</span>

        <span class="c1"># if this branch has children then split it</span>
        <span class="k">if</span> <span class="n">children</span><span class="p">:</span>
            <span class="c1"># if it&#39;s a leaf:</span>
            <span class="k">if</span> <span class="n">prune</span> <span class="ow">and</span> <span class="n">rname</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">and</span> <span class="n">children</span><span class="p">:</span>
                <span class="n">cross</span> <span class="o">+=</span> <span class="n">BOX_HORIZ</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cross</span> <span class="o">+=</span> <span class="n">BOX_HORIZ_DOWN</span>

    <span class="k">if</span> <span class="n">prune</span> <span class="ow">and</span> <span class="n">rname</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">and</span> <span class="n">children</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span> <span class="o">+</span> <span class="n">margins</span> <span class="o">+</span> <span class="p">[</span><span class="n">cross</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="n">rname</span><span class="p">,</span> <span class="s1">&#39;]&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span> <span class="o">+</span> <span class="n">margins</span> <span class="o">+</span> <span class="p">[</span><span class="n">cross</span><span class="p">,</span> <span class="n">rname</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">visited</span><span class="p">[</span><span class="n">rname</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># if this item has children:</span>
    <span class="k">if</span> <span class="n">children</span><span class="p">:</span>
        <span class="n">margin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Initialize margin with 1 for vertical bar.</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">IDX</span><span class="p">(</span><span class="n">showtags</span><span class="p">)</span>
        <span class="n">_child</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Initialize this for the first child.</span>
        <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">children</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">_child</span> <span class="o">=</span> <span class="n">_child</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># number the children</span>
            <span class="n">print_tree</span><span class="p">(</span>
                <span class="n">C</span><span class="p">,</span>
                <span class="n">child_func</span><span class="p">,</span>
                <span class="n">prune</span><span class="p">,</span>
                <span class="n">idx</span><span class="p">,</span>
                <span class="n">margin</span><span class="p">,</span>
                <span class="n">visited</span><span class="p">,</span>
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span> <span class="o">-</span> <span class="n">_child</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">singleLineDraw</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="c1"># margins are with space (index 0) because we arrived to the last child.</span>
        <span class="n">margin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># for this call child and nr of children needs to be set 0, to signal the second phase.</span>
        <span class="n">print_tree</span><span class="p">(</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">child_func</span><span class="p">,</span> <span class="n">prune</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">singleLineDraw</span><span class="p">)</span>
        <span class="n">margin</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>  <span class="c1"># destroy the last margin added</span></div>


<div class="viewcode-block" id="do_flatten"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.do_flatten">[docs]</a><span class="k">def</span> <span class="nf">do_flatten</span><span class="p">(</span>
    <span class="n">sequence</span><span class="p">,</span>
    <span class="n">result</span><span class="p">,</span>
    <span class="nb">isinstance</span><span class="o">=</span><span class="nb">isinstance</span><span class="p">,</span>
    <span class="n">StringTypes</span><span class="o">=</span><span class="n">StringTypes</span><span class="p">,</span>
    <span class="n">SequenceTypes</span><span class="o">=</span><span class="n">SequenceTypes</span><span class="p">,</span>
<span class="p">):</span>  <span class="c1"># pylint: disable=redefined-outer-name,redefined-builtin</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">StringTypes</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">SequenceTypes</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">do_flatten</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="flatten"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.flatten">[docs]</a><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span>  <span class="c1"># pylint: disable=redefined-outer-name,redefined-builtin</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="nb">isinstance</span><span class="o">=</span><span class="nb">isinstance</span><span class="p">,</span>
    <span class="n">StringTypes</span><span class="o">=</span><span class="n">StringTypes</span><span class="p">,</span>
    <span class="n">SequenceTypes</span><span class="o">=</span><span class="n">SequenceTypes</span><span class="p">,</span>
    <span class="n">do_flatten</span><span class="o">=</span><span class="n">do_flatten</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flatten a sequence to a non-nested list.</span>

<span class="sd">    Converts either a single scalar or a nested sequence to a non-nested list.</span>
<span class="sd">    Note that :func:`flatten` considers strings</span>
<span class="sd">    to be scalars instead of sequences like pure Python would.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">StringTypes</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">SequenceTypes</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">StringTypes</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">SequenceTypes</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">do_flatten</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="flatten_sequence"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.flatten_sequence">[docs]</a><span class="k">def</span> <span class="nf">flatten_sequence</span><span class="p">(</span>  <span class="c1"># pylint: disable=redefined-outer-name,redefined-builtin</span>
    <span class="n">sequence</span><span class="p">,</span>
    <span class="nb">isinstance</span><span class="o">=</span><span class="nb">isinstance</span><span class="p">,</span>
    <span class="n">StringTypes</span><span class="o">=</span><span class="n">StringTypes</span><span class="p">,</span>
    <span class="n">SequenceTypes</span><span class="o">=</span><span class="n">SequenceTypes</span><span class="p">,</span>
    <span class="n">do_flatten</span><span class="o">=</span><span class="n">do_flatten</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flatten a sequence to a non-nested list.</span>

<span class="sd">    Same as :func:`flatten`, but it does not handle the single scalar case.</span>
<span class="sd">    This is slightly more efficient when one knows that the sequence</span>
<span class="sd">    to flatten can not be a scalar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">StringTypes</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">SequenceTypes</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">do_flatten</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span></div>


<span class="c1"># The SCons &quot;semi-deep&quot; copy.</span>
<span class="c1">#</span>
<span class="c1"># This makes separate copies of lists (including UserList objects)</span>
<span class="c1"># dictionaries (including UserDict objects) and tuples, but just copies</span>
<span class="c1"># references to anything else it finds.</span>
<span class="c1">#</span>
<span class="c1"># A special case is any object that has a __semi_deepcopy__() method,</span>
<span class="c1"># which we invoke to create the copy. Currently only used by</span>
<span class="c1"># BuilderDict to actually prevent the copy operation (as invalid on that object).</span>
<span class="c1">#</span>
<span class="c1"># The dispatch table approach used here is a direct rip-off from the</span>
<span class="c1"># normal Python copy module.</span>

<div class="viewcode-block" id="semi_deepcopy_dict"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.semi_deepcopy_dict">[docs]</a><span class="k">def</span> <span class="nf">semi_deepcopy_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">semi_deepcopy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">}</span></div>

<div class="viewcode-block" id="_semi_deepcopy_list"><a class="viewcode-back" href="../../../SCons/#SCons.Builder._semi_deepcopy_list">[docs]</a><span class="k">def</span> <span class="nf">_semi_deepcopy_list</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">semi_deepcopy</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">]</span></div>

<div class="viewcode-block" id="_semi_deepcopy_tuple"><a class="viewcode-back" href="../../../SCons/#SCons.Builder._semi_deepcopy_tuple">[docs]</a><span class="k">def</span> <span class="nf">_semi_deepcopy_tuple</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">semi_deepcopy</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span></div>

<span class="n">_semi_deepcopy_dispatch</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">dict</span><span class="p">:</span> <span class="n">semi_deepcopy_dict</span><span class="p">,</span>
    <span class="nb">list</span><span class="p">:</span> <span class="n">_semi_deepcopy_list</span><span class="p">,</span>
    <span class="nb">tuple</span><span class="p">:</span> <span class="n">_semi_deepcopy_tuple</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="semi_deepcopy"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.semi_deepcopy">[docs]</a><span class="k">def</span> <span class="nf">semi_deepcopy</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">copier</span> <span class="o">=</span> <span class="n">_semi_deepcopy_dispatch</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">copier</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">copier</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__semi_deepcopy__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__semi_deepcopy__</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__semi_deepcopy__</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">UserDict</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">semi_deepcopy_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">UserList</span><span class="p">,</span> <span class="n">deque</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">_semi_deepcopy_list</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">obj</span></div>


<div class="viewcode-block" id="Proxy"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Proxy">[docs]</a><span class="k">class</span> <span class="nc">Proxy</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple generic Proxy class, forwarding all calls to subject.</span>

<span class="sd">    This means you can take an object, let&#39;s call it `&#39;obj_a`,</span>
<span class="sd">    and wrap it in this Proxy class, with a statement like this::</span>

<span class="sd">        proxy_obj = Proxy(obj_a)</span>

<span class="sd">    Then, if in the future, you do something like this::</span>

<span class="sd">        x = proxy_obj.var1</span>

<span class="sd">    since the :class:`Proxy` class does not have a :attr:`var1` attribute</span>
<span class="sd">    (but presumably `objA` does), the request actually is equivalent to saying::</span>

<span class="sd">        x = obj_a.var1</span>

<span class="sd">    Inherit from this class to create a Proxy.</span>

<span class="sd">    With Python 3.5+ this does *not* work transparently</span>
<span class="sd">    for :class:`Proxy` subclasses that use special .__*__() method names,</span>
<span class="sd">    because those names are now bound to the class, not the individual</span>
<span class="sd">    instances.  You now need to know in advance which special method names you</span>
<span class="sd">    want to pass on to the underlying Proxy object, and specifically delegate</span>
<span class="sd">    their calls like this::</span>

<span class="sd">        class Foo(Proxy):</span>
<span class="sd">            __str__ = Delegate(&#39;__str__&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrap an object as a Proxy object&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subject</span> <span class="o">=</span> <span class="n">subject</span>

<div class="viewcode-block" id="Proxy.__getattr__"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Proxy.__getattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve an attribute from the wrapped object.</span>

<span class="sd">        Raises:</span>
<span class="sd">           AttributeError: if attribute `name` doesn&#39;t exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subject</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Proxy.get"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Proxy.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the entire wrapped object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subject</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subject</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subject</span> <span class="o">==</span> <span class="n">other</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="vm">__dict__</span></div>


<div class="viewcode-block" id="Delegate"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Delegate">[docs]</a><span class="k">class</span> <span class="nc">Delegate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Python Descriptor class that delegates attribute fetches</span>
<span class="sd">    to an underlying wrapped subject of a Proxy.  Typical use::</span>

<span class="sd">        class Foo(Proxy):</span>
<span class="sd">            __str__ = Delegate(&#39;__str__&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute</span>

    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_subject</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>


<span class="c1"># attempt to load the windows registry module:</span>
<span class="n">can_read_reg</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">winreg</span>

    <span class="n">can_read_reg</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">hkey_mod</span> <span class="o">=</span> <span class="n">winreg</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<div class="viewcode-block" id="_NoError"><a class="viewcode-back" href="../../../SCons/#SCons.Builder._NoError">[docs]</a>    <span class="k">class</span> <span class="nc">_NoError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="k">pass</span></div>
    <span class="n">RegError</span> <span class="o">=</span> <span class="n">_NoError</span>

<span class="k">if</span> <span class="n">can_read_reg</span><span class="p">:</span>
    <span class="n">HKEY_CLASSES_ROOT</span> <span class="o">=</span> <span class="n">hkey_mod</span><span class="o">.</span><span class="n">HKEY_CLASSES_ROOT</span>
    <span class="n">HKEY_LOCAL_MACHINE</span> <span class="o">=</span> <span class="n">hkey_mod</span><span class="o">.</span><span class="n">HKEY_LOCAL_MACHINE</span>
    <span class="n">HKEY_CURRENT_USER</span> <span class="o">=</span> <span class="n">hkey_mod</span><span class="o">.</span><span class="n">HKEY_CURRENT_USER</span>
    <span class="n">HKEY_USERS</span> <span class="o">=</span> <span class="n">hkey_mod</span><span class="o">.</span><span class="n">HKEY_USERS</span>

    <span class="n">RegOpenKeyEx</span> <span class="o">=</span> <span class="n">winreg</span><span class="o">.</span><span class="n">OpenKeyEx</span>
    <span class="n">RegEnumKey</span> <span class="o">=</span> <span class="n">winreg</span><span class="o">.</span><span class="n">EnumKey</span>
    <span class="n">RegEnumValue</span> <span class="o">=</span> <span class="n">winreg</span><span class="o">.</span><span class="n">EnumValue</span>
    <span class="n">RegQueryValueEx</span> <span class="o">=</span> <span class="n">winreg</span><span class="o">.</span><span class="n">QueryValueEx</span>
    <span class="n">RegError</span> <span class="o">=</span> <span class="n">winreg</span><span class="o">.</span><span class="n">error</span>

    <span class="k">def</span> <span class="nf">RegGetValue</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a registry value without having to open the key first.</span>

<span class="sd">        Only available on Windows platforms with a version of Python that</span>
<span class="sd">        can read the registry.</span>

<span class="sd">        Returns the same thing as :func:`RegQueryValueEx`, except you just</span>
<span class="sd">        specify the entire path to the value, and don&#39;t have to bother</span>
<span class="sd">        opening the key first.  So, instead of::</span>

<span class="sd">          k = SCons.Util.RegOpenKeyEx(SCons.Util.HKEY_LOCAL_MACHINE,</span>
<span class="sd">                r&#39;SOFTWARE\Microsoft\Windows\CurrentVersion&#39;)</span>
<span class="sd">          out = SCons.Util.RegQueryValueEx(k, &#39;ProgramFilesDir&#39;)</span>

<span class="sd">        You can write::</span>

<span class="sd">          out = SCons.Util.RegGetValue(SCons.Util.HKEY_LOCAL_MACHINE,</span>
<span class="sd">                r&#39;SOFTWARE\Microsoft\Windows\CurrentVersion\ProgramFilesDir&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># I would use os.path.split here, but it&#39;s not a filesystem</span>
        <span class="c1"># path...</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">keyp</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># -1 to omit trailing slash</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">RegOpenKeyEx</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">keyp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">RegQueryValueEx</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>


<span class="k">else</span><span class="p">:</span>
    <span class="n">HKEY_CLASSES_ROOT</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">HKEY_LOCAL_MACHINE</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">HKEY_CURRENT_USER</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">HKEY_USERS</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="RegGetValue"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.RegGetValue">[docs]</a>    <span class="k">def</span> <span class="nf">RegGetValue</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">OSError</span></div>

<div class="viewcode-block" id="RegOpenKeyEx"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.RegOpenKeyEx">[docs]</a>    <span class="k">def</span> <span class="nf">RegOpenKeyEx</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">OSError</span></div>


<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">WhereIs</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pathext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_String</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pathext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pathext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATHEXT&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">pathext</span> <span class="o">=</span> <span class="s1">&#39;.COM;.EXE;.BAT;.CMD&#39;</span>
        <span class="k">if</span> <span class="n">is_String</span><span class="p">(</span><span class="n">pathext</span><span class="p">):</span>
            <span class="n">pathext</span> <span class="o">=</span> <span class="n">pathext</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">pathext</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">file</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">):]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">pathext</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">reject</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_List</span><span class="p">(</span><span class="n">reject</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_Tuple</span><span class="p">(</span><span class="n">reject</span><span class="p">):</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="p">[</span><span class="n">reject</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">pathext</span><span class="p">:</span>
                <span class="n">fext</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">ext</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fext</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">reject</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">fext</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">fext</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;os2&#39;</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">WhereIs</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pathext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_String</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pathext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pathext</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.exe&#39;</span><span class="p">,</span> <span class="s1">&#39;.cmd&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">pathext</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">file</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">):]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">pathext</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">reject</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_List</span><span class="p">(</span><span class="n">reject</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_Tuple</span><span class="p">(</span><span class="n">reject</span><span class="p">):</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="p">[</span><span class="n">reject</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">pathext</span><span class="p">:</span>
                <span class="n">fext</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">ext</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fext</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">reject</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">fext</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">fext</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">else</span><span class="p">:</span>

<div class="viewcode-block" id="WhereIs"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.WhereIs">[docs]</a>    <span class="k">def</span> <span class="nf">WhereIs</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pathext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="kn">import</span> <span class="nn">stat</span>  <span class="c1"># pylint: disable=import-outside-toplevel</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_String</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reject</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_List</span><span class="p">(</span><span class="n">reject</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_Tuple</span><span class="p">(</span><span class="n">reject</span><span class="p">):</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="p">[</span><span class="n">reject</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">st</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                    <span class="c1"># os.stat() raises OSError, not IOError if the file</span>
                    <span class="c1"># doesn&#39;t exist, so in this case we let IOError get</span>
                    <span class="c1"># raised so as to not mask possibly serious disk or</span>
                    <span class="c1"># network issues.</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IMODE</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">stat</span><span class="o">.</span><span class="n">ST_MODE</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mo">0o111</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">reject</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<span class="n">WhereIs</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Return the path to an executable that matches `file`.</span>

<span class="s2">Searches the given `path` for `file`, respecting any filename</span>
<span class="s2">extensions `pathext` (on the Windows platform only), and</span>
<span class="s2">returns the full path to the matching command.  If no</span>
<span class="s2">command is found, return ``None``.</span>

<span class="s2">If `path` is not specified, :attr:`os.environ[PATH]` is used.</span>
<span class="s2">If `pathext` is not specified, :attr:`os.environ[PATHEXT]`</span>
<span class="s2">is used. Will not select any path name or names in the optional</span>
<span class="s2">`reject` list.</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;cygwin&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">subprocess</span>  <span class="c1"># pylint: disable=import-outside-toplevel</span>

    <span class="k">def</span> <span class="nf">get_native_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">((</span><span class="s1">&#39;cygpath&#39;</span><span class="p">,</span> <span class="s1">&#39;-w&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">),</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cp</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
<div class="viewcode-block" id="get_native_path"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.get_native_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_native_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">path</span></div>

<span class="n">get_native_path</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Transform an absolute path into a native path for the system.</span>

<span class="s2">In Cygwin, this converts from a Cygwin path to a Windows path,</span>
<span class="s2">without regard to whether `path` refers to an existing file</span>
<span class="s2">system object.  For other platforms, `path` is unchanged.</span>
<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="Split"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Split">[docs]</a><span class="k">def</span> <span class="nf">Split</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of file names or other objects.</span>

<span class="sd">    If `arg` is a string, it will be split on strings of white-space</span>
<span class="sd">    characters within the string.  If `arg` is already a list, the list</span>
<span class="sd">    will be returned untouched. If `arg` is any other type of object,</span>
<span class="sd">    it will be returned as a list containing just the object.</span>

<span class="sd">    &gt;&gt;&gt; print(Split(&quot; this  is  a  string  &quot;))</span>
<span class="sd">    [&#39;this&#39;, &#39;is&#39;, &#39;a&#39;, &#39;string&#39;]</span>
<span class="sd">    &gt;&gt;&gt; print(Split([&quot;stringlist&quot;, &quot; preserving &quot;, &quot; spaces &quot;]))</span>
<span class="sd">    [&#39;stringlist&#39;, &#39; preserving &#39;, &#39; spaces &#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_List</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_Tuple</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">arg</span>

    <span class="k">if</span> <span class="n">is_String</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">arg</span><span class="p">]</span></div>


<div class="viewcode-block" id="CLVar"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.CLVar">[docs]</a><span class="k">class</span> <span class="nc">CLVar</span><span class="p">(</span><span class="n">UserList</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A container for command-line construction variables.</span>

<span class="sd">    Forces the use of a list of strings intended as command-line</span>
<span class="sd">    arguments.  Like :class:`collections.UserList`, but the argument</span>
<span class="sd">    passed to the initializter will be processed by the :func:`Split`</span>
<span class="sd">    function, which includes special handling for string types: they</span>
<span class="sd">    will be split into a list of words, not coereced directly to a list.</span>
<span class="sd">    The same happens if a string is added to a :class:`CLVar`,</span>
<span class="sd">    which allows doing the right thing with both</span>
<span class="sd">    :func:`Append`/:func:`Prepend` methods,</span>
<span class="sd">    as well as with pure Python addition, regardless of whether adding</span>
<span class="sd">    a list or a string to a construction variable.</span>

<span class="sd">    Side effect: spaces will be stripped from individual string</span>
<span class="sd">    arguments. If you need spaces preserved, pass strings containing</span>
<span class="sd">    spaces inside a list argument.</span>

<span class="sd">    &gt;&gt;&gt; u = UserList(&quot;--some --opts and args&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(len(u), repr(u))</span>
<span class="sd">    22 [&#39;-&#39;, &#39;-&#39;, &#39;s&#39;, &#39;o&#39;, &#39;m&#39;, &#39;e&#39;, &#39; &#39;, &#39;-&#39;, &#39;-&#39;, &#39;o&#39;, &#39;p&#39;, &#39;t&#39;, &#39;s&#39;, &#39; &#39;, &#39;a&#39;, &#39;n&#39;, &#39;d&#39;, &#39; &#39;, &#39;a&#39;, &#39;r&#39;, &#39;g&#39;, &#39;s&#39;]</span>
<span class="sd">    &gt;&gt;&gt; c = CLVar(&quot;--some --opts and args&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(len(c), repr(c))</span>
<span class="sd">    4 [&#39;--some&#39;, &#39;--opts&#39;, &#39;and&#39;, &#39;args&#39;]</span>
<span class="sd">    &gt;&gt;&gt; c += &quot;    strips spaces    &quot;</span>
<span class="sd">    &gt;&gt;&gt; print(len(c), repr(c))</span>
<span class="sd">    6 [&#39;--some&#39;, &#39;--opts&#39;, &#39;and&#39;, &#39;args&#39;, &#39;strips&#39;, &#39;spaces&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initlist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">Split</span><span class="p">(</span><span class="n">initlist</span> <span class="k">if</span> <span class="n">initlist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">CLVar</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="n">CLVar</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">(</span><span class="n">CLVar</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Some cases the data can contain Nodes, so make sure they</span>
        <span class="c1"># processed to string before handing them over to join.</span>
        <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">])</span></div>


<div class="viewcode-block" id="Selector"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Selector">[docs]</a><span class="k">class</span> <span class="nc">Selector</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A callable ordered dictionary that maps file suffixes to</span>
<span class="sd">    dictionary values.  We preserve the order in which items are added</span>
<span class="sd">    so that :func:`get_suffix` calls always return the first suffix added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ext</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_suffix</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># Try to perform Environment substitution on the keys of</span>
            <span class="c1"># the dictionary before giving up.</span>
            <span class="n">s_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">s_k</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">subst</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">s_k</span> <span class="ow">in</span> <span class="n">s_dict</span><span class="p">:</span>
                        <span class="c1"># We only raise an error when variables point</span>
                        <span class="c1"># to the same suffix.  If one suffix is literal</span>
                        <span class="c1"># and a variable suffix contains this literal,</span>
                        <span class="c1"># the literal wins and we don&#39;t raise an error.</span>
                        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">s_dict</span><span class="p">[</span><span class="n">s_k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">,</span> <span class="n">s_k</span><span class="p">)</span>
                    <span class="n">s_dict</span><span class="p">[</span><span class="n">s_k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">s_dict</span><span class="p">[</span><span class="n">ext</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span></div>


<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;cygwin&#39;</span><span class="p">:</span>
    <span class="c1"># On Cygwin, os.path.normcase() lies, so just report back the</span>
    <span class="c1"># fact that the underlying Windows OS is case-insensitive.</span>
    <span class="k">def</span> <span class="nf">case_sensitive_suffixes</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># pylint: disable=unused-argument</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">else</span><span class="p">:</span>
<div class="viewcode-block" id="case_sensitive_suffixes"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.case_sensitive_suffixes">[docs]</a>    <span class="k">def</span> <span class="nf">case_sensitive_suffixes</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normcase</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normcase</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span></div>


<div class="viewcode-block" id="adjustixes"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.adjustixes">[docs]</a><span class="k">def</span> <span class="nf">adjustixes</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">suf</span><span class="p">,</span> <span class="n">ensure_suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust filename prefixes and suffixes as needed.</span>

<span class="sd">    Add `prefix` to `fname` if specified.</span>
<span class="sd">    Add `suffix` to `fname` if specified and if `ensure_suffix` is ``True``</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pre</span><span class="p">:</span>
        <span class="n">path</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>

        <span class="c1"># Handle the odd case where the filename = the prefix.</span>
        <span class="c1"># In that case, we still want to add the prefix to the file</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fn</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fn</span> <span class="o">==</span> <span class="n">pre</span><span class="p">:</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pre</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span>
    <span class="c1"># Only append a suffix if the suffix we&#39;re going to add isn&#39;t already</span>
    <span class="c1"># there, and if either we&#39;ve been asked to ensure the specific suffix</span>
    <span class="c1"># is present or there&#39;s no suffix on it at all.</span>
    <span class="c1"># Also handle the odd case where the filename = the suffix.</span>
    <span class="c1"># in that case we still want to append the suffix</span>
    <span class="k">if</span> <span class="n">suf</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fname</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suf</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="p">(</span><span class="n">ensure_suffix</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">splitext</span><span class="p">(</span><span class="n">fname</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">fname</span> <span class="o">+</span> <span class="n">suf</span>
    <span class="k">return</span> <span class="n">fname</span></div>


<span class="c1"># From Tim Peters,</span>
<span class="c1"># https://code.activestate.com/recipes/52560</span>
<span class="c1"># ASPN: Python Cookbook: Remove duplicates from a sequence</span>
<span class="c1"># (Also in the printed Python Cookbook.)</span>
<span class="c1"># Updated. This algorithm is used by some scanners and tools.</span>

<div class="viewcode-block" id="unique"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.unique">[docs]</a><span class="k">def</span> <span class="nf">unique</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of the elements in seq without duplicates, ignoring order.</span>

<span class="sd">    &gt;&gt;&gt; mylist = unique([1, 2, 3, 1, 2, 3])</span>
<span class="sd">    &gt;&gt;&gt; print(sorted(mylist))</span>
<span class="sd">    [1, 2, 3]</span>
<span class="sd">    &gt;&gt;&gt; mylist = unique(&quot;abcabc&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(sorted(mylist))</span>
<span class="sd">    [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="sd">    &gt;&gt;&gt; mylist = unique(([1, 2], [2, 3], [1, 2]))</span>
<span class="sd">    &gt;&gt;&gt; print(sorted(mylist))</span>
<span class="sd">    [[1, 2], [2, 3]]</span>

<span class="sd">    For best speed, all sequence elements should be hashable.  Then</span>
<span class="sd">    unique() will usually work in linear time.</span>

<span class="sd">    If not possible, the sequence elements should enjoy a total</span>
<span class="sd">    ordering, and if list(s).sort() doesn&#39;t raise TypeError it&#39;s</span>
<span class="sd">    assumed that they do enjoy a total ordering.  Then unique() will</span>
<span class="sd">    usually work in O(N*log2(N)) time.</span>

<span class="sd">    If that&#39;s not possible either, the sequence elements must support</span>
<span class="sd">    equality-testing.  Then unique() will usually work in quadratic time.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">seq</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># Try using a dict first, as that&#39;s the fastest and will usually</span>
    <span class="c1"># work.  If it doesn&#39;t work, it will usually fail quickly, so it</span>
    <span class="c1"># usually doesn&#39;t cost much to *try* it.  It requires that all the</span>
    <span class="c1"># sequence elements be hashable, and support equality comparison.</span>
    <span class="c1"># TODO: should be even faster: return(list(set(seq)))</span>
    <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span>

    <span class="c1"># We couldn&#39;t hash all the elements (got a TypeError).</span>
    <span class="c1"># Next fastest is to sort, which brings the equal elements together;</span>
    <span class="c1"># then duplicates are easy to weed out in a single pass.</span>
    <span class="c1"># NOTE:  Python&#39;s list.sort() was designed to be efficient in the</span>
    <span class="c1"># presence of many duplicate elements.  This isn&#39;t true of all</span>
    <span class="c1"># sort functions in all languages or libraries, so this approach</span>
    <span class="c1"># is more effective in Python than it may be elsewhere.</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>    <span class="c1"># move on to the next method</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lasti</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last</span><span class="p">:</span>
                <span class="n">t</span><span class="p">[</span><span class="n">lasti</span><span class="p">]</span> <span class="o">=</span> <span class="n">last</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">lasti</span> <span class="o">=</span> <span class="n">lasti</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[:</span><span class="n">lasti</span><span class="p">]</span>

    <span class="c1"># Brute force is all that&#39;s left.</span>
    <span class="n">u</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
            <span class="n">u</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span></div>

<span class="c1"># Best way (assuming Python 3.7, but effectively 3.6) to remove</span>
<span class="c1"># duplicates from a list in while preserving order, according to</span>
<span class="c1"># https://stackoverflow.com/questions/480214/how-do-i-remove-duplicates-from-a-list-while-preserving-order/17016257#17016257</span>
<div class="viewcode-block" id="uniquer_hashables"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.uniquer_hashables">[docs]</a><span class="k">def</span> <span class="nf">uniquer_hashables</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div>

<span class="c1"># Recipe 19.11 &quot;Reading Lines with Continuation Characters&quot;,</span>
<span class="c1"># by Alex Martelli, straight from the Python CookBook (2nd edition).</span>
<div class="viewcode-block" id="logical_lines"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.logical_lines">[docs]</a><span class="k">def</span> <span class="nf">logical_lines</span><span class="p">(</span><span class="n">physical_lines</span><span class="p">,</span> <span class="n">joiner</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">):</span>
    <span class="n">logical_line</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">physical_lines</span><span class="p">:</span>
        <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">stripped</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="c1"># a line which continues w/the next physical line</span>
            <span class="n">logical_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripped</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># a line which does not continue, end of logical line</span>
            <span class="n">logical_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">joiner</span><span class="p">(</span><span class="n">logical_line</span><span class="p">)</span>
            <span class="n">logical_line</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">logical_line</span><span class="p">:</span>
        <span class="c1"># end of sequence implies end of last logical line</span>
        <span class="k">yield</span> <span class="n">joiner</span><span class="p">(</span><span class="n">logical_line</span><span class="p">)</span></div>


<div class="viewcode-block" id="LogicalLines"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.LogicalLines">[docs]</a><span class="k">class</span> <span class="nc">LogicalLines</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Wrapper class for the logical_lines method.</span>

<span class="sd">    Allows us to read all &quot;logical&quot; lines at once from a given file object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span>

<div class="viewcode-block" id="LogicalLines.readlines"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.LogicalLines.readlines">[docs]</a>    <span class="k">def</span> <span class="nf">readlines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">logical_lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="UniqueList"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList">[docs]</a><span class="k">class</span> <span class="nc">UniqueList</span><span class="p">(</span><span class="n">UserList</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A list which maintains uniqueness.</span>

<span class="sd">    Uniquing is lazy: rather than being assured on list changes, it is fixed</span>
<span class="sd">    up on access by those methods which need to act on a unique list to be</span>
<span class="sd">    correct. That means things like &quot;in&quot; don&#39;t have to eat the uniquing time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initlist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">initlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__make_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">uniquer_hashables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__le__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__gt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__ge__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="c1"># __contains__ doesn&#39;t need to worry about uniquing, inherit</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># __delitem__ doesn&#39;t need to worry about uniquing, inherit</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__rmul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__imul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="UniqueList.append"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="UniqueList.insert"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="UniqueList.count"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList.count">[docs]</a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="UniqueList.index"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList.index">[docs]</a>    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="UniqueList.reverse"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList.reverse">[docs]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span></div>

    <span class="c1"># TODO: Py3.8: def sort(self, /, *args, **kwds):</span>
<div class="viewcode-block" id="UniqueList.sort"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__make_unique</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span></div>

<div class="viewcode-block" id="UniqueList.extend"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.UniqueList.extend">[docs]</a>    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">False</span></div></div>


<div class="viewcode-block" id="Unbuffered"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Unbuffered">[docs]</a><span class="k">class</span> <span class="nc">Unbuffered</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A proxy  that wraps a file object, flushing after every write.</span>

<span class="sd">    Delegates everything else to the wrapped object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file</span>

<div class="viewcode-block" id="Unbuffered.write"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Unbuffered.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="c1"># Stdout might be connected to a pipe that has been closed</span>
        <span class="c1"># by now. The most likely reason for the pipe being closed</span>
        <span class="c1"># is that the user has press ctrl-c. It this is the case,</span>
        <span class="c1"># then SCons is currently shutdown. We therefore ignore</span>
        <span class="c1"># IOError&#39;s here so that SCons can continue and shutdown</span>
        <span class="c1"># properly so that the .sconsign is correctly written</span>
        <span class="c1"># before SCons exits.</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>

<div class="viewcode-block" id="Unbuffered.writelines"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.Unbuffered.writelines">[docs]</a>    <span class="k">def</span> <span class="nf">writelines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="make_path_relative"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.make_path_relative">[docs]</a><span class="k">def</span> <span class="nf">make_path_relative</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts an absolute path name to a relative pathname.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">drive_s</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitdrive</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">drive_s</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/*(.*)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">assert</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">path</span>
    <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="silent_intern"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.silent_intern">[docs]</a><span class="k">def</span> <span class="nf">silent_intern</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform :mod:`sys.intern` on the passed argument and return the result.</span>
<span class="sd">    If the input is ineligible for interning the original argument is</span>
<span class="sd">    returned and no exception is thrown.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">intern</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span></div>


<div class="viewcode-block" id="cmp"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.cmp">[docs]</a><span class="k">def</span> <span class="nf">cmp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A cmp function because one is no longer available in python3.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="print_time"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.print_time">[docs]</a><span class="k">def</span> <span class="nf">print_time</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hack to return a value from Main if can&#39;t import Main.&quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=redefined-outer-name,import-outside-toplevel</span>
    <span class="kn">from</span> <span class="nn">SCons.Script.Main</span> <span class="kn">import</span> <span class="n">print_time</span>
    <span class="k">return</span> <span class="n">print_time</span></div>


<div class="viewcode-block" id="wait_for_process_to_die"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.wait_for_process_to_die">[docs]</a><span class="k">def</span> <span class="nf">wait_for_process_to_die</span><span class="p">(</span><span class="n">pid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wait for specified process to die, or alternatively kill it</span>
<span class="sd">    NOTE: This function operates best with psutil pypi package</span>
<span class="sd">    TODO: Add timeout which raises exception</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># wait for the process to fully killed</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">psutil</span>  <span class="c1"># pylint: disable=import-outside-toplevel</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">proc</span><span class="o">.</span><span class="n">pid</span> <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">psutil</span><span class="o">.</span><span class="n">process_iter</span><span class="p">()]:</span>
                <span class="k">break</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="c1"># if psutil is not installed we can do this the hard way</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">ctypes</span>  <span class="c1"># pylint: disable=import-outside-toplevel</span>
                <span class="n">PROCESS_QUERY_INFORMATION</span> <span class="o">=</span> <span class="mh">0x1000</span>
                <span class="n">processHandle</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span><span class="o">.</span><span class="n">OpenProcess</span><span class="p">(</span><span class="n">PROCESS_QUERY_INFORMATION</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">processHandle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span><span class="o">.</span><span class="n">CloseHandle</span><span class="p">(</span><span class="n">processHandle</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span></div>

<span class="c1"># From: https://stackoverflow.com/questions/1741972/how-to-use-different-formatters-with-the-same-logging-handler-in-python</span>
<div class="viewcode-block" id="DispatchingFormatter"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.DispatchingFormatter">[docs]</a><span class="k">class</span> <span class="nc">DispatchingFormatter</span><span class="p">(</span><span class="n">Formatter</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatters</span><span class="p">,</span> <span class="n">default_formatter</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_formatters</span> <span class="o">=</span> <span class="n">formatters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_formatter</span> <span class="o">=</span> <span class="n">default_formatter</span>

<div class="viewcode-block" id="DispatchingFormatter.format"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.DispatchingFormatter.format">[docs]</a>    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_formatter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="sanitize_shell_env"><a class="viewcode-back" href="../../../SCons/#SCons.Builder.sanitize_shell_env">[docs]</a><span class="k">def</span> <span class="nf">sanitize_shell_env</span><span class="p">(</span><span class="n">execution_env</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sanitize all values in *execution_env*</span>

<span class="sd">    The execution environment (typically comes from (env[&#39;ENV&#39;]) is</span>
<span class="sd">    propagated to the shell, and may need to be cleaned first.</span>

<span class="sd">    Args:</span>
<span class="sd">        execution_env: The shell environment variables to be propagated</span>
<span class="sd">        to the spawned shell.</span>

<span class="sd">    Returns:</span>
<span class="sd">        sanitized dictionary of env variables (similar to what you&#39;d get</span>
<span class="sd">        from :data:`os.environ`)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure that the ENV values are all strings:</span>
    <span class="n">new_env</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">execution_env</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">is_List</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="c1"># If the value is a list, then we assume it is a path list,</span>
            <span class="c1"># because that&#39;s a pretty common list-like value to stick</span>
            <span class="c1"># in an environment variable:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">flatten_sequence</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">new_env</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># It&#39;s either a string or something else.  If it isn&#39;t a</span>
            <span class="c1"># string or a list, then we just coerce it to a string, which</span>
            <span class="c1"># is the proper way to handle Dir and File instances and will</span>
            <span class="c1"># produce something reasonable for just about everything else:</span>
            <span class="n">new_env</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_env</span></div>

<span class="c1"># Local Variables:</span>
<span class="c1"># tab-width:4</span>
<span class="c1"># indent-tabs-mode:nil</span>
<span class="c1"># End:</span>
<span class="c1"># vim: set expandtab tabstop=4 shiftwidth=4:</span>
</pre></div>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By SCons Project Team<br/>
  
      &copy; Copyright 2022, SCons Project.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>