<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>15.2. Why SCons Duplicates Source Files in a Variant Directory Tree</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 4.5.0"><link rel="up" href="ch15.html" title="Chapter 15. Separating Source and Build Trees: Variant Directories"><link rel="prev" href="ch15.html" title="Chapter 15. Separating Source and Build Trees: Variant Directories"><link rel="next" href="ch15s03.html" title="15.3. Telling SCons to Not Duplicate Source Files in the Variant Directory Tree"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.2. Why <span class="application">SCons</span> Duplicates Source Files in a Variant Directory Tree</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch15.html">Prev</a> </td><th width="60%" align="center">Chapter 15. Separating Source and Build Trees: Variant Directories</th><td width="20%" align="right"> <a accesskey="n" href="ch15s03.html">Next</a></td></tr></table><hr></div><div class="section" title="15.2. Why SCons Duplicates Source Files in a Variant Directory Tree"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect-variant-duplication"></a>15.2. Why <span class="application">SCons</span> Duplicates Source Files in a Variant Directory Tree</h2></div></div></div><p>

    When you set up a variant directory <span class="application">SCons</span> conceptually behaves as
    if you requested a build in that directory.
    As noted in the previous chapter,
    all builds actually happen from the top level directory,
    but as an aid to understanding how <span class="application">SCons</span> operates, think
    of it as <span class="emphasis"><em>build in place in the variant directory</em></span>,
    not <span class="emphasis"><em>build in source but send build artifacts
    to the variant directory</em></span>.
    It turns out in place builds are easier to get right than out
    of tree builds - so by default <span class="application">SCons</span> simulates an in place build
    by making the variant directory look just like the source directory.
    The most straightforward way to do that is by making copies
    of the files needed for the build.

    </p><p>

    The most direct reason to duplicate source files
    in variant directories
    is simply that some tools (mostly older versions)
    are written to only build their output files
    in the same directory as the source files - such tools often don't
    have any option to specify the output file, and the tool just
    uses a predefined output file name,
    or uses a derived variant of the source file name,
    dropping the result in the same directory.
    In this case, the choices are either
    to build the output file in the source directory
    and move it to the variant directory,
    or to duplicate the source files in the variant directory.

    </p><p>

    Additionally,
    relative references between files
    can cause problems which are resolved by
    just duplicating the hierarchy of source files
    into the variant directory.
    You can see this at work in
    use of the C preprocessor <code class="literal">#include</code>
    mechanism with double quotes, not angle brackets:

    </p><pre class="programlisting">
#include "file.h"
    </pre><p>

    The <span class="emphasis"><em>de facto</em></span> standard behavior
    for most C compilers in this case
    is to first look in the same directory
    as the source file that contains the <code class="literal">#include</code> line,
    then to look in the directories in the preprocessor search path.
    Add to this that the <span class="application">SCons</span> implementation of
    support for code repositories
    (described below)
    means not all of the files
    will be found in the same directory hierarchy,
    and the simplest way to make sure
    that the right include file is found
    is to duplicate the source files into the variant directory,
    which provides a correct build
    regardless of the original location(s) of the source files.

    </p><p>

    Although source-file duplication guarantees a correct build
    even in these edge cases,
    it can <span class="emphasis"><em>usually</em></span> be safely disabled.
    The next section describes
    how you can disable the duplication of source files
    in the variant directory.

    </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch15.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch15.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch15s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 15. Separating Source and Build Trees: Variant Directories </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 15.3. Telling <span class="application">SCons</span> to Not Duplicate Source Files in the Variant Directory Tree</td></tr></table></div></body></html>
