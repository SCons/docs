<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>26.4. Building C Header and Stub Files: the JavaH Builder</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 4.0.1"><link rel="up" href="ch26.html" title="Chapter 26. Java Builds"><link rel="prev" href="ch26s03.html" title="26.3. Building Java Archive (.jar) Files: the Jar Builder"><link rel="next" href="ch26s05.html" title="26.5. Building RMI Stub and Skeleton Class Files: the RMIC Builder"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">26.4. Building C Header and Stub Files:  the <code class="function">JavaH</code> Builder</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch26s03.html">Prev</a> </td><th width="60%" align="center">Chapter 26. Java Builds</th><td width="20%" align="right"> <a accesskey="n" href="ch26s05.html">Next</a></td></tr></table><hr></div><div class="section" title="26.4. Building C Header and Stub Files: the JavaH Builder"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp140430752322424"></a>26.4. Building C Header and Stub Files:  the <code class="function">JavaH</code> Builder</h2></div></div></div><p>

    You can generate C header and source files
    for implementing native methods,
    by using the <a class="link" href="apb.html#b-JavaH"><code class="function">JavaH</code></a> Builder.
    There are several ways of using the <code class="function">JavaH</code> Builder.
    One typical invocation might look like:

    </p><pre class="programlisting">
classes = Java(target = 'classes', source = 'src/pkg/sub')
JavaH(target = 'native', source = classes)
      </pre><p>

    The source is a list of class files generated by the
    call to the <a class="link" href="apb.html#b-Java"><code class="function">Java</code></a> Builder,
    and the target is the output directory in
    which we want the C header files placed.
    The target
    gets converted into the <code class="option">-d</code>
    when <span class="application">SCons</span> runs <span class="application">javah</span>:

    </p><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
javac -d classes -sourcepath src/pkg/sub src/pkg/sub/Example1.java src/pkg/sub/Example2.java src/pkg/sub/Example3.java
javah -d native -classpath classes pkg.sub.Example1 pkg.sub.Example2 pkg.sub.Example3
</pre><p>

    In this case,
    the call to <span class="application">javah</span>
    will generate the header files
    <code class="filename">native/pkg_sub_Example1.h</code>,
    <code class="filename">native/pkg_sub_Example2.h</code>
    and
    <code class="filename">native/pkg_sub_Example3.h</code>.
    Notice that <span class="application">SCons</span> remembered that the class
    files were generated with a target directory of
    <code class="filename">classes</code>,
    and that it then specified that target directory
    as the <code class="option">-classpath</code> option
    to the call to <span class="application">javah</span>.

    </p><p>

    Although it's more convenient to use
    the list of class files returned by
    the <code class="function">Java</code> Builder
    as the source of a call to the <code class="function">JavaH</code> Builder,
    you <span class="emphasis"><em>can</em></span>
    specify the list of class files
    by hand, if you prefer.
    If you do,
    you need to set the
    <a class="link" href="apa.html#cv-JAVACLASSDIR"><code class="envar">$JAVACLASSDIR</code></a> construction variable
    when calling <code class="function">JavaH</code>:

    </p><pre class="programlisting">
Java(target = 'classes', source = 'src/pkg/sub')
class_file_list = ['classes/pkg/sub/Example1.class',
                   'classes/pkg/sub/Example2.class',
                   'classes/pkg/sub/Example3.class']
JavaH(target = 'native', source = class_file_list, JAVACLASSDIR = 'classes')
      </pre><p>

    The <code class="envar">$JAVACLASSDIR</code> value then
    gets converted into the <code class="option">-classpath</code>
    when <span class="application">SCons</span> runs <span class="application">javah</span>:

    </p><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
javac -d classes -sourcepath src/pkg/sub src/pkg/sub/Example1.java src/pkg/sub/Example2.java src/pkg/sub/Example3.java
javah -d native -classpath classes pkg.sub.Example1 pkg.sub.Example2 pkg.sub.Example3
</pre><p>

    Lastly, if you don't want a separate header file
    generated for each source file,
    you can specify an explicit File Node
    as the target of the <code class="function">JavaH</code> Builder:

    </p><pre class="programlisting">
classes = Java(target = 'classes', source = 'src/pkg/sub')
JavaH(target = File('native.h'), source = classes)
      </pre><p>

    Because <span class="application">SCons</span> assumes by default
    that the target of the <code class="function">JavaH</code> builder is a directory,
    you need to use the <code class="function">File</code> function
    to make sure that <span class="application">SCons</span> doesn't
    create a directory named <code class="filename">native.h</code>.
    When a file is used, though,
    <span class="application">SCons</span> correctly converts the file name
    into the <span class="application">javah</span> <code class="option">-o</code> option:

    </p><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
javac -d classes -sourcepath src/pkg/sub src/pkg/sub/Example1.java src/pkg/sub/Example2.java src/pkg/sub/Example3.java
javah -o native.h -classpath classes pkg.sub.Example1 pkg.sub.Example2 pkg.sub.Example3
</pre></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch26s03.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch26.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch26s05.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">26.3. Building Java Archive (<code class="filename">.jar</code>) Files:  the <code class="function">Jar</code> Builder </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 26.5. Building RMI Stub and Skeleton Class Files:  the <code class="function">RMIC</code> Builder</td></tr></table></div></body></html>
