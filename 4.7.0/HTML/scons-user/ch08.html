<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 8. Automatically Putting Command-line Options into their Construction Variables</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 4.7.0"><link rel="up" href="index.html" title="SCons 4.7.0"><link rel="prev" href="ch07s04.html" title="7.4. Using the toolpath for external Tools"><link rel="next" href="ch08s02.html" title="8.2. Merging Options While Creating Environment: the parse_flags Parameter"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 8. Automatically Putting Command-line Options into their Construction Variables</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07s04.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch08s02.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 8. Automatically Putting Command-line Options into their Construction Variables"><div class="titlepage"><div><div><h2 class="title"><a name="chap-manip-options"></a>Chapter 8. Automatically Putting Command-line Options into their Construction Variables</h2></div></div></div><p>
    This chapter describes the <code class="function">MergeFlags</code>, <code class="function">ParseFlags</code>, and <code class="function">ParseConfig</code>
    methods of a <span>construction environment</span>, as well as the <em class="parameter"><code>parse_flags</code></em>
    keyword argument to methods that construct environments.
    </p><div class="section" title="8.1. Merging Options into the Environment: the MergeFlags Function"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect-mergeflags"></a>8.1. Merging Options into the Environment: the <code class="function">MergeFlags</code> Function</h2></div></div></div><p>

 <span class="application">SCons</span> <span>construction environments</span> have a <a class="link" href="apd.html#f-MergeFlags"><code class="function">MergeFlags</code></a> method
 that merges values from a passed-in argument into the <span>construction environment</span>.
 If the argument is a dictionary,
 <code class="function">MergeFlags</code> treats each value in the dictionary
 as a list of options you would pass to a command
 (such as a compiler or linker).
 <code class="function">MergeFlags</code> will not duplicate an option
 if it already exists in the <span>construction variable</span>.
 If the argument is a string, <code class="function">MergeFlags</code> calls the
 <a class="link" href="apd.html#f-ParseFlags"><code class="function">ParseFlags</code></a> method to burst it out into a
 dictionary first, then acts on the result.

 </p><p>

 <code class="function">MergeFlags</code> tries to be intelligent about merging options,
 knowing that different <span>construction variables</span> may have different needs.
 When merging options to any variable
 whose name ends in <code class="literal">PATH</code>,
 <code class="function">MergeFlags</code> keeps the leftmost occurrence of the option,
 because in typical lists of directory paths,
 the first occurrence "wins."
 When merging options to any other variable name,
 <code class="function">MergeFlags</code> keeps the rightmost occurrence of the option,
 because in a list of typical command-line options,
 the last occurrence "wins."

 </p><pre class="programlisting">
env = Environment()
env.Append(CCFLAGS='-option -O3 -O1')
flags = {'CCFLAGS': '-whatever -O3'}
env.MergeFlags(flags)
print("CCFLAGS:", env['CCFLAGS'])
   </pre><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
CCFLAGS: ['-option', '-O1', '-whatever', '-O3']
scons: `.' is up to date.
</pre><p>

 Note that the default value for <a class="link" href="apa.html#cv-CCFLAGS"><code class="envar">$CCFLAGS</code></a>
 
 is an internal <span class="application">SCons</span> object
 which automatically converts
 the options you specify as a string into a list.

 </p><pre class="programlisting">
env = Environment()
env.Append(CPPPATH=['/include', '/usr/local/include', '/usr/include'])
flags = {'CPPPATH': ['/usr/opt/include', '/usr/local/include']}
env.MergeFlags(flags)
print("CPPPATH:", env['CPPPATH'])
   </pre><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
CPPPATH: ['/include', '/usr/local/include', '/usr/include', '/usr/opt/include']
scons: `.' is up to date.
</pre><p>

 Note that the default value for <a class="link" href="apa.html#cv-CPPPATH"><code class="envar">$CPPPATH</code></a>
 
 is a normal <span class="application">Python</span> list,
 so you should give its values as a list
 in the dictionary you pass to the <code class="function">MergeFlags</code> function.

 </p><p>

 If <code class="function">MergeFlags</code> is passed anything other than a dictionary,
 it calls the <code class="function">ParseFlags</code> method to convert it into a dictionary.

 </p><pre class="programlisting">
env = Environment()
env.Append(CCFLAGS='-option -O3 -O1')
env.Append(CPPPATH=['/include', '/usr/local/include', '/usr/include'])
env.MergeFlags('-whatever -I/usr/opt/include -O3 -I/usr/local/include')
print("CCFLAGS:", env['CCFLAGS'])
print("CPPPATH:", env['CPPPATH'])
   </pre><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
CCFLAGS: ['-option', '-O1', '-whatever', '-O3']
CPPPATH: ['/include', '/usr/local/include', '/usr/include', '/usr/opt/include']
scons: `.' is up to date.
</pre><p>

 In the combined example above,
 <code class="function">ParseFlags</code> has sorted the options into their corresponding variables
 and returned a dictionary for <code class="function">MergeFlags</code> to apply
 to the <span>construction variables</span>
 in the specified <span>construction environment</span>.

 </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07s04.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch08s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">7.4. Using the toolpath for external Tools </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 8.2. Merging Options While Creating Environment: the <em class="parameter"><code>parse_flags</code></em> Parameter</td></tr></table></div></body></html>
