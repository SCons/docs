<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>17.5. Builders That Create Actions Using a Generator</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 4.8.1"><link rel="up" href="ch17.html" title="Chapter 17. Extending SCons: Writing Your Own Builders"><link rel="prev" href="ch17s04.html" title="17.4. Builders That Execute Python Functions"><link rel="next" href="ch17s06.html" title="17.6. Builders That Modify the Target or Source Lists Using an Emitter"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">17.5. Builders That Create Actions Using a <span>Generator</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch17s04.html">Prev</a> </td><th width="60%" align="center">Chapter 17. Extending <span class="application">SCons</span>: Writing Your Own Builders</th><td width="20%" align="right"> <a accesskey="n" href="ch17s06.html">Next</a></td></tr></table><hr></div><div class="section" title="17.5. Builders That Create Actions Using a Generator"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id5703"></a>17.5. Builders That Create Actions Using a <span>Generator</span></h2></div></div></div><p>

    <span class="application">SCons</span> Builder objects can create an action "on the fly"
    by using a function called a <em class="firstterm"><span>Generator</span></em>.
    (Note: this is not the same thing as a <span class="application">Python</span> generator function
    described in <a class="ulink" href="https://www.python.org/dev/peps/pep-0255/" target="_top">PEP 255</a>)
    This provides a great deal of flexibility to
    construct just the right list of commands
    to build your target.
    A <span>generator</span> looks like:

    </p><pre class="programlisting">
def generate_actions(source, target, env, for_signature):
    return 'foobuild &lt; %s &gt; %s' % (target[0], source[0])
    </pre><p>

    The arguments of a <span>generator</span> are:

    </p><div class="variablelist"><dl><dt><span class="term"><em class="parameter"><code>source</code></em></span></dt><dd><p>

      A list of Node objects representing
      the sources to be built
      by the command or other action
      generated by this function.
      The file names of these source(s)
      may be extracted using the <span class="application">Python</span> <code class="function">str</code> function.

      </p></dd><dt><span class="term"><em class="parameter"><code>target</code></em></span></dt><dd><p>

      A list of Node objects representing
      the target or targets to be built
      by the command or other action
      generated by this function.
      The file names of these target(s)
      may be extracted using the <span class="application">Python</span> <code class="function">str</code> function.

      </p></dd><dt><span class="term"><em class="parameter"><code>env</code></em></span></dt><dd><p>

      The <span>construction environment</span> used for building the target(s).
      The <span>generator</span> may use any of the
      environment's <span>construction variables</span>
      in any way to determine what command
      or other action to return.

      </p></dd><dt><span class="term"><em class="parameter"><code>for_signature</code></em></span></dt><dd><p>

      A flag that specifies whether the
      <span>generator</span> is being called to contribute to a <span>build signature</span>,
      as opposed to actually executing the command.

      

      </p></dd></dl></div><p>

    The <span>generator</span> must return a
    command string or other action that will be used to
    build the specified target(s) from the specified source(s).

    </p><p>

    Once you've defined a <span>generator</span>,
    you create a <em class="glossterm">Builder</em> to use it
    by specifying the <em class="parameter"><code>generator</code></em> keyword argument
    instead of <em class="parameter"><code>action</code></em>.

    </p><pre class="programlisting">
def generate_actions(source, target, env, for_signature):
    return 'foobuild &lt; %s &gt; %s' % (source[0], target[0])

bld = Builder(
    generator=generate_actions,
    suffix='.foo',
    src_suffix='.input',
)
env = Environment(BUILDERS={'Foo': bld})
env.Foo('file')
    </pre><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
foobuild &lt; file.input &gt; file.foo
</pre><p>

    Note that it's illegal to specify both an
    <em class="parameter"><code>action</code></em>
    and a
    <em class="parameter"><code>generator</code></em>
    for a <em class="glossterm">Builder</em>.

    </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch17s04.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch17.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch17s06.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">17.4. Builders That Execute Python Functions </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 17.6. Builders That Modify the Target or Source Lists Using an <span>Emitter</span></td></tr></table></div></body></html>
