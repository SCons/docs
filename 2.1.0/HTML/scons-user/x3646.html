<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Builders That Create Actions Using a Generator</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="SCons User Guide 2.1.0"
HREF="index.html"><LINK
REL="UP"
TITLE="Writing Your Own Builders"
HREF="c3512.html"><LINK
REL="PREVIOUS"
TITLE="Builders That Execute Python Functions"
HREF="x3610.html"><LINK
REL="NEXT"
TITLE="Builders That Modify the Target or Source Lists Using an Emitter"
HREF="x3689.html"></HEAD
><BODY
CLASS="section"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>SCons User Guide 2.1.0</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x3610.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 17. Writing Your Own Builders</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x3689.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="section"
><H1
CLASS="section"
><A
NAME="AEN3646"
>17.5. Builders That Create Actions Using a <TT
CLASS="literal"
>Generator</TT
></A
></H1
><P
>&#13;
    <SPAN
CLASS="application"
>SCons</SPAN
> Builder objects can create an action "on the fly"
    by using a function called a <TT
CLASS="literal"
>generator</TT
>.
    This provides a great deal of flexibility to
    construct just the right list of commands
    to build your target.
    A <TT
CLASS="literal"
>generator</TT
> looks like:

    </P
><PRE
CLASS="programlisting"
>&#13;       def generate_actions(source, target, env, for_signature):
           return 'foobuild &#60; %s &#62; %s' % (target[0], source[0])
    </PRE
><P
>&#13;
    The arguments of a <TT
CLASS="literal"
>generator</TT
> are:

    </P
><P
></P
><DIV
CLASS="variablelist"
><DL
><DT
>source</DT
><DD
><P
>&#13;
      A list of Node objects representing
      the sources to be built
      by the command or other action
      generated by this function.
      The file names of these source(s)
      may be extracted using the Python <CODE
CLASS="function"
>str</CODE
> function.

      </P
></DD
><DT
>target</DT
><DD
><P
>&#13;
      A list of Node objects representing
      the target or targets to be built
      by the command or other action
      generated by this function.
      The file names of these target(s)
      may be extracted using the Python <CODE
CLASS="function"
>str</CODE
> function.

      </P
></DD
><DT
>env</DT
><DD
><P
>&#13;
      The <TT
CLASS="literal"
>construction environment</TT
> used for building the target(s).
      The generator may use any of the
      environment's construction variables
      in any way to determine what command
      or other action to return.

      </P
></DD
><DT
>for_signature</DT
><DD
><P
>&#13;
      A flag that specifies whether the
      generator is being called to contribute to a build signature,
      as opposed to actually executing the command.

      

      </P
></DD
></DL
></DIV
><P
>&#13;
    The <TT
CLASS="literal"
>generator</TT
> must return a
    command string or other action that will be used to
    build the specified target(s) from the specified source(s).

    </P
><P
>&#13;
    Once you've defined a <TT
CLASS="literal"
>generator</TT
>,
    you create a <CODE
CLASS="classname"
>Builder</CODE
> to use it
    by specifying the generator keyword argument
    instead of <TT
CLASS="literal"
>action</TT
>.

    </P
><PRE
CLASS="programlisting"
>&#13;       def generate_actions(source, target, env, for_signature):
           return 'foobuild &#60; %s &#62; %s' % (source[0], target[0])
       bld = Builder(generator = generate_actions,
                     suffix = '.foo',
                     src_suffix = '.input')
       env = Environment(BUILDERS = {'Foo' : bld})
       env.Foo('file')
    </PRE
><PRE
CLASS="screen"
>&#13;      % <KBD
CLASS="userinput"
>scons -Q</KBD
>
      foobuild &#60; file.input &#62; file.foo
    </PRE
><P
>&#13;
    Note that it's illegal to specify both an
    <TT
CLASS="literal"
>action</TT
>
    and a
    <TT
CLASS="literal"
>generator</TT
>
    for a <CODE
CLASS="classname"
>Builder</CODE
>.

    </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x3610.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x3689.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Builders That Execute Python Functions</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c3512.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Builders That Modify the Target or Source Lists Using an <TT
CLASS="literal"
>Emitter</TT
></TD
></TR
></TABLE
></DIV
></BODY
></HTML
>