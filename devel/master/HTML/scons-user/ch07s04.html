<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>7.4. Using the toolpath for external Tools</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 4.2.0"><link rel="up" href="ch07.html" title="Chapter 7. Environments"><link rel="prev" href="ch07s03.html" title="7.3. Controlling the Execution Environment for Issued Commands"><link rel="next" href="ch08.html" title="Chapter 8. Automatically Putting Command-line Options into their Construction Variables"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.4. Using the toolpath for external Tools</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07s03.html">Prev</a> </td><th width="60%" align="center">Chapter 7. Environments</th><td width="20%" align="right"> <a accesskey="n" href="ch08.html">Next</a></td></tr></table><hr></div><div class="section" title="7.4. Using the toolpath for external Tools"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect-environment-toolpath"></a>7.4. Using the toolpath for external Tools</h2></div></div></div><div class="section" title="7.4.1. The default tool search path"><div class="titlepage"><div><div><h3 class="title"><a name="idp140721293025008"></a>7.4.1. The default tool search path</h3></div></div></div><p>
      Normally when using a tool from the construction environment,
      several different search locations are checked by default.
      This includes the <code class="filename">SCons/Tools/</code> directory
      that is part of the <span class="command"><strong>scons</strong></span> distribution
      and the directory <code class="filename">site_scons/site_tools</code>
      relative to the root <code class="filename">SConstruct</code> file.
      </p><pre class="programlisting">
# Builtin tool or tool located within site_tools
env = Environment(tools=['SomeTool'])
env.SomeTool(targets, sources)

# The search locations would include by default
SCons/Tool/SomeTool.py
SCons/Tool/SomeTool/__init__.py
./site_scons/site_tools/SomeTool.py
./site_scons/site_tools/SomeTool/__init__.py
      </pre></div><div class="section" title="7.4.2. Providing an external directory to toolpath"><div class="titlepage"><div><div><h3 class="title"><a name="idp140721293028656"></a>7.4.2. Providing an external directory to toolpath</h3></div></div></div><p>
      In some cases you may want to specify a different location to search for tools.
      The <a class="link" href="apd.html#f-Environment"><code class="function">Environment</code></a> function contains an option for this called
      <em class="parameter"><code>toolpath</code></em>
      This can be used to add additional search directories.
      </p><pre class="programlisting">
# Tool located within the toolpath directory option
env = Environment(
    tools=['SomeTool'],
    toolpath=['/opt/SomeToolPath', '/opt/SomeToolPath2']
)
env.SomeTool(targets, sources)

# The search locations in this example would include:
/opt/SomeToolPath/SomeTool.py
/opt/SomeToolPath/SomeTool/__init__.py
/opt/SomeToolPath2/SomeTool.py
/opt/SomeToolPath2/SomeTool/__init__.py
SCons/Tool/SomeTool.py
SCons/Tool/SomeTool/__init__.py
./site_scons/site_tools/SomeTool.py
./site_scons/site_tools/SomeTool/__init__.py
      </pre></div><div class="section" title="7.4.3. Nested Tools within a toolpath"><div class="titlepage"><div><div><h3 class="title"><a name="idp140721293032144"></a>7.4.3. Nested Tools within a toolpath</h3></div></div></div><p>

      Since <span class="application">SCons</span> 3.0, a Builder may be located
      within a sub-directory / sub-package of the toolpath.
      This is similar to namespacing within <span class="application">Python</span>.
      
      With nested or namespaced tools we can use the dot notation
      to specify a sub-directory that the tool is located under.

      </p><pre class="programlisting">
# namespaced target
env = Environment(
    tools=['SubDir1.SubDir2.SomeTool'],
    toolpath=['/opt/SomeToolPath']
)
env.SomeTool(targets, sources)

# With this example the search locations would include
/opt/SomeToolPath/SubDir1/SubDir2/SomeTool.py
/opt/SomeToolPath/SubDir1/SubDir2/SomeTool/__init__.py
SCons/Tool/SubDir1/SubDir2/SomeTool.py
SCons/Tool/SubDir1/SubDir2/SomeTool/__init__.py
./site_scons/site_tools/SubDir1/SubDir2/SomeTool.py
./site_scons/site_tools/SubDir1/SubDir2/SomeTool/__init__.py
      </pre></div><div class="section" title="7.4.4. Using sys.path within the toolpath"><div class="titlepage"><div><div><h3 class="title"><a name="idp140721293035600"></a>7.4.4. Using sys.path within the toolpath</h3></div></div></div><p>
      If we want to access tools external to <span class="command"><strong>scons</strong></span> which are findable
      via <code class="varname">sys.path</code>
      (for example, tools installed via Python's <span class="command"><strong>pip</strong></span> package manager),
      it is possible to use <code class="varname">sys.path</code> with the toolpath.

      One thing to watch out for with this approach is that
      <code class="varname">sys.path</code>
      can sometimes contains paths to <code class="filename">.egg</code>
      files instead of directories.
      So we need to filter those out with this approach.
      </p><pre class="programlisting">
# namespaced target using sys.path within toolpath

searchpaths = []
for item in sys.path:
    if os.path.isdir(item):
        searchpaths.append(item)

env = Environment(
    tools=['someinstalledpackage.SomeTool'],
    toolpath=searchpaths
)
env.SomeTool(targets, sources)
      </pre><p>
      By using <code class="varname">sys.path</code> with the toolpath argument
      and by using the nested syntax we can have <span class="command"><strong>scons</strong></span> search
      packages installed via <span class="command"><strong>pip</strong></span> for Tools.
      </p><pre class="programlisting">
# For Windows based on the python version and install directory, this may be something like
C:\Python35\Lib\site-packages\someinstalledpackage\SomeTool.py
C:\Python35\Lib\site-packages\someinstalledpackage\SomeTool\__init__.py

# For Linux this could be something like:
/usr/lib/python3/dist-packages/someinstalledpackage/SomeTool.py
/usr/lib/python3/dist-packages/someinstalledpackage/SomeTool/__init__.py
</pre></div><div class="section" title="7.4.5. Using the PyPackageDir function to add to the toolpath"><div class="titlepage"><div><div><h3 class="title"><a name="idp140721293042608"></a>7.4.5. Using the <code class="function">PyPackageDir</code> function to add to the toolpath</h3></div></div></div><p>
      In some cases you may want to use a tool
      located within a installed external pip package.
      This is possible by the use of
      <code class="varname">sys.path</code> with the toolpath.
      However in that situation you need to provide a prefix to the toolname
      to indicate where it is located within <code class="varname">sys.path</code>.
      </p><pre class="programlisting">
searchpaths = []
for item in sys.path:
    if os.path.isdir(item):
        searchpaths.append(item)
env = Environment(
    tools=['tools_example.subdir1.subdir2.SomeTool'],
    toolpath=searchpaths
)
env.SomeTool(targets, sources)
      </pre><p>
      To avoid the use of a prefix within the name of the tool or filtering
      <code class="varname">sys.path</code> for directories,
      we can use <a class="link" href="apd.html#f-PyPackageDir"><code class="function">PyPackageDir</code></a> function to locate the directory of
      the python package.
      <code class="function">PyPackageDir</code> returns a Dir object which represents the path of the
      directory
      for the python package / module specified as a parameter.
      </p><pre class="programlisting">
# namespaced target using sys.path
env = Environment(
    tools=['SomeTool'],
    toolpath=[PyPackageDir('tools_example.subdir1.subdir2')]
)
env.SomeTool(targets, sources)
      </pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07s03.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch07.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch08.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">7.3. Controlling the Execution Environment for Issued Commands </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 8. Automatically Putting Command-line Options into their Construction Variables</td></tr></table></div></body></html>
