<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 15. Separating Source and Build Directories</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 2.3.2"><link rel="up" href="index.html" title="SCons 2.3.2"><link rel="prev" href="ch14s05.html" title="14.5. Sharing Environments (and Other Variables) Between SConscript Files"><link rel="next" href="ch15s02.html" title="15.2. Why SCons Duplicates Source Files in a Variant Directory Tree"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 15. Separating Source and Build Directories</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch14s05.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch15s02.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 15. Separating Source and Build Directories"><div class="titlepage"><div><div><h2 class="title"><a name="chap-separate"></a>Chapter 15. Separating Source and Build Directories</h2></div></div></div><p>

  It's often useful to keep any built files completely
  separate from the source files.
  In <span class="application">SCons</span>, this is usually done by creating one or more separate
  <span class="emphasis"><em>variant directory trees</em></span>
  that are used to hold the built objects files, libraries,
  and executable programs, etc.
  for a specific flavor, or variant, of build.
  <span class="application">SCons</span> provides two ways to do this,
  one through the <code class="filename">SConscript</code> function that we've already seen,
  and the second through a more flexible <code class="function">VariantDir</code> function.

  </p><p>

  One historical note:  the <code class="function">VariantDir</code> function
  used to be called <code class="function">BuildDir</code>.
  That name is still supported
  but has been deprecated
  because the <span class="application">SCons</span> functionality
  differs from the model of a "build directory"
  implemented by other build systems like the GNU Autotools.

  </p><div class="section" title="15.1. Specifying a Variant Directory Tree as Part of an SConscript Call"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm20594896"></a>15.1. Specifying a Variant Directory Tree as Part of an <code class="filename">SConscript</code> Call</h2></div></div></div><p>

    The most straightforward way to establish a variant directory tree
    uses the fact that the usual way to
    set up a build hierarchy is to have an
    <code class="filename">SConscript</code> file in the source subdirectory.
    If you then pass a <code class="varname">variant_dir</code> argument to the
    <code class="filename">SConscript</code> function call:

    </p><pre class="programlisting">
SConscript('src/SConscript', variant_dir='build')
      </pre><p>

    <span class="application">SCons</span> will then build all of the files in
    the <code class="filename">build</code> subdirectory:

    </p><pre class="screen">% <strong class="userinput"><code>ls src</code></strong>
SConscript  hello.c
% <strong class="userinput"><code>scons -Q</code></strong>
cc -o build/hello.o -c build/hello.c
cc -o build/hello build/hello.o
% <strong class="userinput"><code>ls build</code></strong>
SConscript  hello  hello.c  hello.o
</pre><p>

    But wait a minute--what's going on here?
    <span class="application">SCons</span> created the object file
    <code class="filename">build/hello.o</code>
    in the <code class="filename">build</code> subdirectory,
    as expected.
    But even though our <code class="filename">hello.c</code> file lives in the <code class="filename">src</code> subdirectory,
    <span class="application">SCons</span> has actually compiled a
    <code class="filename">build/hello.c</code> file
    to create the object file.

    </p><p>

    What's happened is that <span class="application">SCons</span> has <span class="emphasis"><em>duplicated</em></span>
    the <code class="filename">hello.c</code> file from the <code class="filename">src</code> subdirectory
    to the <code class="filename">build</code> subdirectory,
    and built the program from there.
    The next section explains why <span class="application">SCons</span> does this.

    </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch14s05.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch15s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">14.5. Sharing Environments (and Other Variables) Between <code class="filename">SConscript</code> Files </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 15.2. Why <span class="application">SCons</span> Duplicates Source Files in a Variant Directory Tree</td></tr></table></div></body></html>
