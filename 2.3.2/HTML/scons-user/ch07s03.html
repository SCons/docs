<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>7.3. Controlling the Execution Environment for Issued Commands</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 2.3.2"><link rel="up" href="ch07.html" title="Chapter 7. Environments"><link rel="prev" href="ch07s02.html" title="7.2. Construction Environments"><link rel="next" href="ch08.html" title="Chapter 8. Automatically Putting Command-line Options into their Construction Variables"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.3. Controlling the Execution Environment for Issued Commands</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07s02.html">Prev</a> </td><th width="60%" align="center">Chapter 7. Environments</th><td width="20%" align="right"> <a accesskey="n" href="ch08.html">Next</a></td></tr></table><hr></div><div class="section" title="7.3. Controlling the Execution Environment for Issued Commands"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect-execution-environments"></a>7.3. Controlling the Execution Environment for Issued Commands</h2></div></div></div><p>

      When <span class="application">SCons</span> builds a target file,
      it does not execute the commands with
      the same external environment
      that you used to execute <span class="application">SCons</span>.
      Instead, it uses the dictionary
      stored in the <a class="link" href="apa.html#cv-ENV"><code class="envar">$ENV</code></a> construction variable
      as the external environment
      for executing commands.

    </p><p>

      The most important ramification of this behavior
      is that the <code class="varname">PATH</code> environment variable,
      which controls where the operating system
      will look for commands and utilities,
      is not the same as in the external environment
      from which you called <span class="application">SCons</span>.
      This means that <span class="application">SCons</span> will not, by default,
      necessarily find all of the tools
      that you can execute from the command line.

    </p><p>

      The default value of the <code class="varname">PATH</code> environment variable
      on a POSIX system
      is <code class="literal">/usr/local/bin:/bin:/usr/bin</code>.
      The default value of the <code class="varname">PATH</code> environment variable
      on a Windows system comes from the Windows registry
      value for the command interpreter.
      If you want to execute any commands--compilers, linkers, etc.--that
      are not in these default locations,
      you need to set the <code class="varname">PATH</code> value
      in the <code class="envar">$ENV</code> dictionary
      in your construction environment.

    </p><p>

      The simplest way to do this is to initialize explicitly
      the value when you create the construction environment;
      this is one way to do that:

    </p><pre class="programlisting">
path = ['/usr/local/bin', '/bin', '/usr/bin']
env = Environment(ENV = {'PATH' : path})
    </pre><p>

    Assign a dictionary to the <code class="envar">$ENV</code>
    construction variable in this way
    completely resets the external environment
    so that the only variable that will be
    set when external commands are executed
    will be the <code class="varname">PATH</code> value.
    If you want to use the rest of
    the values in <code class="envar">$ENV</code> and only
    set the value of <code class="varname">PATH</code>,
    the most straightforward way is probably:

    </p><pre class="programlisting">
env['ENV']['PATH'] = ['/usr/local/bin', '/bin', '/usr/bin']
    </pre><p>

    Note that <span class="application">SCons</span> does allow you to define
    the directories in the <code class="varname">PATH</code> in a string,
    separated by the pathname-separator character
    for your system (':' on POSIX systems, ';' on Windows):

    </p><pre class="programlisting">
env['ENV']['PATH'] = '/usr/local/bin:/bin:/usr/bin'
    </pre><p>

    But doing so makes your <code class="filename">SConscript</code> file less portable,
    (although in this case that may not be a huge concern
    since the directories you list are likley system-specific, anyway).

    </p><div class="section" title="7.3.1. Propagating PATH From the External Environment"><div class="titlepage"><div><div><h3 class="title"><a name="idp1126536"></a>7.3.1. Propagating <code class="varname">PATH</code> From the External Environment</h3></div></div></div><p>

      You may want to propagate the external <code class="varname">PATH</code>
      to the execution environment for commands.
      You do this by initializing the <code class="varname">PATH</code>
      variable with the <code class="varname">PATH</code> value from
      the <code class="literal">os.environ</code>
      dictionary,
      which is Python's way of letting you
      get at the external environment:

      </p><pre class="programlisting">
import os
env = Environment(ENV = {'PATH' : os.environ['PATH']})
      </pre><p>

      Alternatively, you may find it easier
      to just propagate the entire external
      environment to the execution environment
      for commands.
      This is simpler to code than explicity
      selecting the <code class="varname">PATH</code> value:

      </p><pre class="programlisting">
import os
env = Environment(ENV = os.environ)
      </pre><p>

      Either of these will guarantee that
      <span class="application">SCons</span> will be able to execute
      any command that you can execute from the command line.
      The drawback is that the build can behave
      differently if it's run by people with
      different <code class="varname">PATH</code> values in their environment--for example,
      if both the <code class="literal">/bin</code> and
      <code class="literal">/usr/local/bin</code> directories
      have different <span class="application">cc</span> commands,
      then which one will be used to compile programs
      will depend on which directory is listed
      first in the user's <code class="varname">PATH</code> variable.

      </p></div><div class="section" title="7.3.2. Adding to PATH Values in the Execution Environment"><div class="titlepage"><div><div><h3 class="title"><a name="idp1132440"></a>7.3.2. Adding to <code class="varname">PATH</code> Values in the Execution Environment</h3></div></div></div><p>

      One of the most common requirements
      for manipulating a variable in the execution environment
      is to add one or more custom directories to a search
      like the <code class="envar">$PATH</code> variable on Linux or POSIX systems,
      or the <code class="envar">%PATH%</code> variable on Windows,
      so that a locally-installed compiler or other utility
      can be found when <span class="application">SCons</span> tries to execute it to update a target.
      <span class="application">SCons</span> provides <code class="function">PrependENVPath</code> and <code class="function">AppendENVPath</code> functions
      to make adding things to execution variables convenient.
      You call these functions by specifying the variable
      to which you want the value added,
      and then value itself.
      So to add some <code class="filename">/usr/local</code> directories
      to the <code class="envar">$PATH</code> and <code class="envar">$LIB</code> variables,
      you might:

      </p><pre class="programlisting">
env = Environment(ENV = os.environ)
env.PrependENVPath('PATH', '/usr/local/bin')
env.AppendENVPath('LIB', '/usr/local/lib')
      </pre><p>

      Note that the added values are strings,
      and if you want to add multiple directories to
      a variable like <code class="envar">$PATH</code>,
      you must include the path separate character
      (<code class="literal">:</code> on Linux or POSIX,
      <code class="literal">;</code> on Windows)
      in the string.

      </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch07.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch08.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">7.2. Construction Environments </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 8. Automatically Putting Command-line Options into their Construction Variables</td></tr></table></div></body></html>
