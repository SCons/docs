<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>18.5. Builders That Create Actions Using a Generator</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 2.4.1"><link rel="up" href="ch18.html" title="Chapter 18. Writing Your Own Builders"><link rel="prev" href="ch18s04.html" title="18.4. Builders That Execute Python Functions"><link rel="next" href="ch18s06.html" title="18.6. Builders That Modify the Target or Source Lists Using an Emitter"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.5. Builders That Create Actions Using a <code class="literal">Generator</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch18s04.html">Prev</a> </td><th width="60%" align="center">Chapter 18. Writing Your Own Builders</th><td width="20%" align="right"> <a accesskey="n" href="ch18s06.html">Next</a></td></tr></table><hr></div><div class="section" title="18.5. Builders That Create Actions Using a Generator"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp1403156020"></a>18.5. Builders That Create Actions Using a <code class="literal">Generator</code></h2></div></div></div><p>

    <span class="application">SCons</span> Builder objects can create an action "on the fly"
    by using a function called a <code class="literal">generator</code>.
    This provides a great deal of flexibility to
    construct just the right list of commands
    to build your target.
    A <code class="literal">generator</code> looks like:

    </p><pre class="programlisting">
def generate_actions(source, target, env, for_signature):
    return 'foobuild &lt; %s &gt; %s' % (target[0], source[0])
    </pre><p>

    The arguments of a <code class="literal">generator</code> are:

    </p><div class="variablelist"><dl><dt><span class="term">source</span></dt><dd><p>

      A list of Node objects representing
      the sources to be built
      by the command or other action
      generated by this function.
      The file names of these source(s)
      may be extracted using the Python <code class="function">str</code> function.

      </p></dd><dt><span class="term">target</span></dt><dd><p>

      A list of Node objects representing
      the target or targets to be built
      by the command or other action
      generated by this function.
      The file names of these target(s)
      may be extracted using the Python <code class="function">str</code> function.

      </p></dd><dt><span class="term">env</span></dt><dd><p>

      The <code class="literal">construction environment</code> used for building the target(s).
      The generator may use any of the
      environment's construction variables
      in any way to determine what command
      or other action to return.

      </p></dd><dt><span class="term">for_signature</span></dt><dd><p>

      A flag that specifies whether the
      generator is being called to contribute to a build signature,
      as opposed to actually executing the command.

      

      </p></dd></dl></div><p>

    The <code class="literal">generator</code> must return a
    command string or other action that will be used to
    build the specified target(s) from the specified source(s).

    </p><p>

    Once you've defined a <code class="literal">generator</code>,
    you create a <code class="classname">Builder</code> to use it
    by specifying the generator keyword argument
    instead of <code class="literal">action</code>.

    </p><pre class="programlisting">
def generate_actions(source, target, env, for_signature):
    return 'foobuild &lt; %s &gt; %s' % (source[0], target[0])
bld = Builder(generator = generate_actions,
              suffix = '.foo',
              src_suffix = '.input')
env = Environment(BUILDERS = {'Foo' : bld})
env.Foo('file')
    </pre><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
foobuild &lt; file.input &gt; file.foo
</pre><p>

    Note that it's illegal to specify both an
    <code class="literal">action</code>
    and a
    <code class="literal">generator</code>
    for a <code class="classname">Builder</code>.

    </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch18s04.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch18.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch18s06.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">18.4. Builders That Execute Python Functions </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 18.6. Builders That Modify the Target or Source Lists Using an <code class="literal">Emitter</code></td></tr></table></div></body></html>
