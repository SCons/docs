<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>21.2. Adding a search path to a scanner: FindPathDirs</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 2.4.0"><link rel="up" href="ch21.html" title="Chapter 21. Writing Scanners"><link rel="prev" href="ch21.html" title="Chapter 21. Writing Scanners"><link rel="next" href="ch22.html" title="Chapter 22. Building From Code Repositories"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">21.2. Adding a search path to a scanner: <code class="function">FindPathDirs</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch21.html">Prev</a> </td><th width="60%" align="center">Chapter 21. Writing Scanners</th><td width="20%" align="right"> <a accesskey="n" href="ch22.html">Next</a></td></tr></table><hr></div><div class="section" title="21.2. Adding a search path to a scanner: FindPathDirs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm139970739407136"></a>21.2. Adding a search path to a scanner: <code class="function">FindPathDirs</code></h2></div></div></div><p>

    Many scanners need to search for included files or dependencies
    using a path variable; this is how <a class="link" href="apa.html#cv-CPPPATH"><code class="envar">$CPPPATH</code></a> and
    <a class="link" href="apa.html#cv-LIBPATH"><code class="envar">$LIBPATH</code></a> work.  The path to search is passed to your
    scanner as the <code class="literal">path</code> argument.  Path variables
    may be lists of nodes, semicolon-separated strings, or even
    contain SCons variables which need to be expanded.  Fortunately,
    <span class="application">SCons</span> provides the <code class="function">FindPathDirs</code> function which itself returns
    a function to expand a given path (given as a SCons construction
    variable name) to a list of paths at the time the scanner is
    called.  Deferring evaluation until that point allows, for
    instance, the path to contain $TARGET references which differ for
    each file scanned.

    </p><p>

    Using <code class="function">FindPathDirs</code> is quite easy.  Continuing the above example,
    using KPATH as the construction variable with the search path
    (analogous to <a class="link" href="apa.html#cv-CPPPATH"><code class="envar">$CPPPATH</code></a>), we just modify the <code class="classname">Scanner</code>
    constructor call to include a path keyword arg:

    </p><pre class="programlisting">
kscan = Scanner(function = kfile_scan,
                skeys = ['.k'],
                path=FindPathDirs('KPATH'))
      </pre><p>
    
    FindPathDirs returns a callable object that, when called, will
    essentially expand the elements in env['KPATH'] and tell the
    scanner to search in those dirs.  It will also properly add
    related repository and variant dirs to the search list.  As a side
    note, the returned method stores the path in an efficient way so
    lookups are fast even when variable substitutions may be needed.
    This is important since many files get scanned in a typical build.
    
    </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch21.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch21.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch22.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 21. Writing Scanners </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 22. Building From Code Repositories</td></tr></table></div></body></html>
