<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>26.9. Using Python Virtual Environments</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 4.10.0"><link rel="up" href="ch26.html" title="Chapter 26. Miscellaneous Functionality"><link rel="prev" href="ch26s08.html" title="26.8. Declaring Additional Outputs: the SideEffect Function"><link rel="next" href="ch27.html" title="Chapter 27. Using SCons with other build tools"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">26.9. Using Python Virtual Environments</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch26s08.html">Prev</a> </td><th width="60%" align="center">Chapter 26. Miscellaneous Functionality</th><td width="20%" align="right"> <a accesskey="n" href="ch27.html">Next</a></td></tr></table><hr></div><div class="section" title="26.9. Using Python Virtual Environments"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect-virtualenv"></a>26.9. Using Python Virtual Environments</h2></div></div></div><p>

      <span class="application">Python</span> supports lightweight "virtual environments" (usually
      abbreviated <em class="firstterm">virtualenv</em>) which allow
      encapsulation / isolation of package dependencies for a project.
      When a <span class="application">Python</span> program is executed in the context of a
      virtualenv, the paths for package imports are amended so the
      modules in the virtualenv are preferred. Depending on how the
      virtualenv was configured, system paths may or may not be used
      as a fallback (the default is not).

    </p><p>
      <span class="application">SCons</span> itself works as expected when executed within a virtualenv.
      However, there may be issues if the project needs
      to build using external commands written in <span class="application">Python</span>
      which are installed in the virtualenv,
      or calls the <span class="application">Python</span> interpreter to run a script.
      <span class="application">SCons</span> launches command actions using a special restricted
      <code class="envar">PATH</code> setting which the new process uses
      to find executables.
      This path is part of the execution environment
      (see  <a class="xref" href="ch07s03.html" title="7.3. Controlling the Execution Environment for Issued Commands">Section 7.3, &#8220;Controlling the Execution Environment for Issued Commands&#8221;</a>),
      and by default,
      does not contain any information about the virtualenv.
      The result can be commands not found,
      or scripts executed with the system default copy of <span class="application">Python</span>
      rather than the virtualenv one, possibly causing incorrect imports.
      If you encounter this problem, <span class="application">SCons</span> provides a mechanism
      to more fully integrate with a virtualenv.
    </p><p>
      Use the <code class="option">--enable-virtualenv</code>
      to import virtualenv-related environment variables to the
      execution environment (<a class="link" href="apa.html#cv-ENV"><code class="envar">$ENV</code></a>)
      and to modify the execution environment's <code class="envar">PATH</code>
      appropriately to prefer the virtualenv executables and
      <span class="application">Python</span> interpreter.
    </p><p>
      To make this setting permanent, you can either:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Add it to the <code class="envar">SCONSFLAGS</code> environment variable , or</p></li><li class="listitem"><p>Set <code class="envar">SCONS_ENABLE_VIRTUALENV=1</code> in your environment.</p></li></ul></div><p>
      <code class="envar">SCONSFLAGS</code> is the preferred approach,
      as it's easier to manage a single variable controlling <span class="application">SCons</span>
      behavior than multiples.
      If enabled by environment variable,
      the special virtualenv behavior can be disabled for the current
      run using the <code class="option">--ignore-virtualenv</code> option.
    </p><p>
      You can query the state at runtime by calling
      the <a class="link" href="apd.html#f-Virtualenv"><code class="function">Virtualenv</code></a> global function.
      It returns a path to the virtualenv's home directory,
      or an empty string if <span class="application">SCons</span> is not running in a virtualenv.
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      <code class="function">Virtualenv</code> returns a path even if <span class="application">SCons</span>
      is run from an unactivated virtualenv.
      A virtualenv does not have to be activated to be used,
      you only need to use the path to its <span class="application">Python</span> interpreter,
      but only an activated virtualenv makes available the
      suitable <code class="envar">PATH</code> elements for <span class="application">SCons</span> to
      copy in when <code class="option">--enable-virtualenv</code> is used.
    </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch26s08.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch26.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch27.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">26.8. Declaring Additional Outputs: the <code class="function">SideEffect</code> Function  </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 27. Using SCons with other build tools</td></tr></table></div></body></html>
