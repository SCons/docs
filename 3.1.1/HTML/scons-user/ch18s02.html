<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>18.2. Attaching a Builder to a Construction Environment</title><link rel="stylesheet" type="text/css" href="scons.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="SCons 3.1.1"><link rel="up" href="ch18.html" title="Chapter 18. Writing Your Own Builders"><link rel="prev" href="ch18.html" title="Chapter 18. Writing Your Own Builders"><link rel="next" href="ch18s03.html" title="18.3. Letting SCons Handle The File Suffixes"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.2. Attaching a Builder to a <code class="literal">Construction Environment</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch18.html">Prev</a> </td><th width="60%" align="center">Chapter 18. Writing Your Own Builders</th><td width="20%" align="right"> <a accesskey="n" href="ch18s03.html">Next</a></td></tr></table><hr></div><div class="section" title="18.2. Attaching a Builder to a Construction Environment"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm3678"></a>18.2. Attaching a Builder to a <code class="literal">Construction Environment</code></h2></div></div></div><p>

    A <code class="classname">Builder</code> object isn't useful
    until it's attached to a <code class="literal">construction environment</code>
    so that we can call it to arrange
    for files to be built.
    This is done through the <a class="link" href="apa.html#cv-BUILDERS"><code class="envar">$BUILDERS</code></a>
    <code class="literal">construction variable</code> in an environment.
    The <code class="envar">$BUILDERS</code> variable is a Python dictionary
    that maps the names by which you want to call
    various <code class="classname">Builder</code> objects to the objects themselves.
    For example, if we want to call the
    <code class="classname">Builder</code> we just defined by the name
    <code class="function">Foo</code>,
    our <code class="filename">SConstruct</code> file might look like:

    </p><pre class="programlisting">
bld = Builder(action = 'foobuild &lt; $SOURCE &gt; $TARGET')
env = Environment(BUILDERS = {'Foo' : bld})
    </pre><p>

    With the <code class="classname">Builder</code> attached to our <code class="literal">construction environment</code>
    with the name <code class="function">Foo</code>,
    we can now actually call it like so:

    </p><pre class="programlisting">
env.Foo('file.foo', 'file.input')
    </pre><p>

    Then when we run <span class="application">SCons</span> it looks like:

    </p><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
foobuild &lt; file.input &gt; file.foo
</pre><p>

    Note, however, that the default <code class="envar">$BUILDERS</code>
    variable in a <code class="literal">construction environment</code>
    comes with a default set of <code class="classname">Builder</code> objects
    already defined:
    <a class="link" href="apb.html#b-Program"><code class="function">Program</code></a>, <a class="link" href="apb.html#b-Library"><code class="function">Library</code></a>, etc.
    And when we explicitly set the <code class="envar">$BUILDERS</code> variable
    when we create the <code class="literal">construction environment</code>,
    the default <code class="classname">Builder</code>s are no longer part of
    the environment:

    </p><pre class="programlisting">
bld = Builder(action = 'foobuild &lt; $SOURCE &gt; $TARGET')
env = Environment(BUILDERS = {'Foo' : bld})
env.Foo('file.foo', 'file.input')
env.Program('hello.c')
       </pre><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
AttributeError: 'SConsEnvironment' object has no attribute 'Program':
  File "/home/my/project/SConstruct", line 4:
    env.Program('hello.c')
</pre><p>

    To be able to use both our own defined <code class="classname">Builder</code> objects
    and the default <code class="classname">Builder</code> objects in the same <code class="literal">construction environment</code>,
    you can either add to the <code class="envar">$BUILDERS</code> variable
    using the <code class="function">Append</code> function:

    </p><pre class="programlisting">
env = Environment()
bld = Builder(action = 'foobuild &lt; $SOURCE &gt; $TARGET')
env.Append(BUILDERS = {'Foo' : bld})
env.Foo('file.foo', 'file.input')
env.Program('hello.c')
    </pre><p>

    Or you can explicitly set the appropriately-named
    key in the <code class="envar">$BUILDERS</code> dictionary:

    </p><pre class="programlisting">
env = Environment()
bld = Builder(action = 'foobuild &lt; $SOURCE &gt; $TARGET')
env['BUILDERS']['Foo'] = bld
env.Foo('file.foo', 'file.input')
env.Program('hello.c')
    </pre><p>

    Either way, the same <code class="literal">construction environment</code>
    can then use both the newly-defined
    <code class="function">Foo</code> <code class="classname">Builder</code>
    and the default <a class="link" href="apb.html#b-Program"><code class="function">Program</code></a> <code class="classname">Builder</code>:

    </p><pre class="screen">% <strong class="userinput"><code>scons -Q</code></strong>
foobuild &lt; file.input &gt; file.foo
cc -o hello.o -c hello.c
cc -o hello hello.o
</pre></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch18.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch18.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch18s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 18. Writing Your Own Builders </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 18.3. Letting <span class="application">SCons</span> Handle The File Suffixes</td></tr></table></div></body></html>
