<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Caching Built Files</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="SCons User Guide 1.3.0"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Not Configuring When Cleaning Targets"
HREF="x4142.html"><LINK
REL="NEXT"
TITLE="Keeping Build Output Consistent"
HREF="x4180.html"></HEAD
><BODY
CLASS="chapter"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>SCons User Guide 1.3.0</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x4142.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x4180.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="chapter"
><H1
><A
NAME="chap-caching"
></A
>Chapter 25. Caching Built Files</H1
><P
>&#13;
  On multi-developer software projects,
  you can sometimes speed up every developer's builds a lot by
  allowing them to share the derived files that they build.
  <SPAN
CLASS="application"
>SCons</SPAN
> makes this easy, as well as reliable.

  </P
><DIV
CLASS="section"
><H1
CLASS="section"
><A
NAME="AEN4158"
>25.1. Specifying the Shared Cache Directory</A
></H1
><P
>&#13;
    To enable sharing of derived files,
    use the <CODE
CLASS="function"
>CacheDir</CODE
> function
    in any <TT
CLASS="filename"
>SConscript</TT
> file:

    </P
><PRE
CLASS="programlisting"
>&#13;       CacheDir('/usr/local/build_cache')
    </PRE
><P
>&#13;
    Note that the directory you specify must already exist
    and be readable and writable by all developers
    who will be sharing derived files.
    It should also be in some central location
    that all builds will be able to access.
    In environments where developers are using separate systems
    (like individual workstations) for builds,
    this directory would typically be
    on a shared or NFS-mounted file system.

    </P
><P
>&#13;
    Here's what happens:
    When a build has a <CODE
CLASS="function"
>CacheDir</CODE
> specified,
    every time a file is built,
    it is stored in the shared cache directory
    along with its MD5 build signature.
      <A
NAME="AEN4167"
HREF="#FTN.AEN4167"
><SPAN
CLASS="footnote"
>[1]</SPAN
></A
>
    On subsequent builds,
    before an action is invoked to build a file,
    <SPAN
CLASS="application"
>SCons</SPAN
> will check the shared cache directory
    to see if a file with the exact same build
    signature already exists.
    If so, the derived file will not be built locally,
    but will be copied into the local build directory
    from the shared cache directory,
    like so:

    </P
><PRE
CLASS="screen"
>&#13;      % <KBD
CLASS="userinput"
>scons -Q</KBD
>
      cc -o hello.o -c hello.c
      cc -o hello hello.o
      % <KBD
CLASS="userinput"
>scons -Q -c</KBD
>
      Removed hello.o
      Removed hello
      % <KBD
CLASS="userinput"
>scons -Q</KBD
>
      Retrieved `hello.o' from cache
      Retrieved `hello' from cache
    </PRE
><P
>&#13;
    Note that the <CODE
CLASS="function"
>CacheDir</CODE
> feature still calculates
    MD5 build sigantures for the shared cache file names
    even if you configure <SPAN
CLASS="application"
>SCons</SPAN
> to use timestamps
    to decide if files are up to date.
    (See the <A
HREF="c809.html"
>Chapter 6</A
>
    chapter for information about the <CODE
CLASS="function"
>Decider</CODE
> function.)
    Consequently, using <CODE
CLASS="function"
>CacheDir</CODE
> may reduce or eliminate any
    potential performance improvements
    from using timestamps for up-to-date decisions.

    </P
></DIV
></DIV
><H3
CLASS="FOOTNOTES"
>Notes</H3
><TABLE
BORDER="0"
CLASS="FOOTNOTES"
WIDTH="100%"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.AEN4167"
HREF="c4154.html#AEN4167"
><SPAN
CLASS="footnote"
>[1]</SPAN
></A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>&#13;      Actually, the MD5 signature is used as the name of the file
      in the shared cache directory in which the contents are stored.
      </P
></TD
></TR
></TABLE
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x4142.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x4180.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Not Configuring When Cleaning Targets</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Keeping Build Output Consistent</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>